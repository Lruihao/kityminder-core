/*!
 * ====================================================
 * Kity Minder Core - v1.4.51 - 2024-01-21
 * https://github.com/Lruihao/kityminder-core
 * GitHub: https://github.com/Lruihao/kityminder-core.git 
 * Copyright (c) 2018 Baidu FEX; Licensed BSD-3-Clause
 * 2024 Patch by Lruihao
 * ====================================================
 */
!function(){var m={r:function(e){if(m[e].inited)return m[e].value;if("function"!=typeof m[e].value)return m[e].inited=!0,m[e].value;var t,n={exports:{}},r=m[e].value(null,n.exports,n);if(m[e].inited=!0,void 0!==(m[e].value=r))return r;for(t in n.exports)if(n.exports.hasOwnProperty(t))return m[e].inited=!0,m[e].value=n.exports,n.exports},0:{value:function(e,t,n){var c=m.r(17),r=m.r(11),h=(new c.Marker).pipe(function(){var e=new c.Circle(6);this.addShape(e),this.setRef(6,0).setViewBox(-7,-7,14,14).setWidth(7).setHeight(7),this.dot=e,this.node.setAttribute("markerUnits","userSpaceOnUse")});r.register("arc",function(e,t,n,r,o){var i=e.getLayoutBox(),t=t.getLayoutBox(),a=Math.abs,s=[],u=i.x>t.x?"right":"left";e.getMinder().getPaper().addResource(h),e=new c.Point(t.cx,t.cy),t="left"==u?new c.Point(i.right+2,i.cy):new c.Point(i.left-2,i.cy),u=c.Vector.fromPoints(e,t),s.push("M",e),s.push("A",a(u.x),a(u.y),0,0,0<u.x*u.y?0:1,t),n.setMarker(h),h.dot.fill(o),n.setPathData(s)})}},1:{value:function(e,t,n){var c=m.r(17),r=m.r(11),h=(new c.Marker).pipe(function(){var e=new c.Circle(6);this.addShape(e),this.setRef(6,0).setViewBox(-7,-7,14,14).setWidth(7).setHeight(7),this.dot=e,this.node.setAttribute("markerUnits","userSpaceOnUse")});r.register("arc_tp",function(e,t,n,r,o){var i=e.getLayoutBox(),a=t.getLayoutBox(),s=e.getIndex(),u=t.getChildren()[s+1],t=(0<e.getIndex()&&(a=t.getChildren()[s-1].getLayoutBox()),Math.abs,[]),i=(i.x,a.x,e.getMinder().getPaper().addResource(h),s=new c.Point(a.cx,a.cy),a=new c.Point(i.cx,i.cy),Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2))),i=0==e.getIndex()?.4*i:i;c.Vector.fromPoints(s,a);t.push("M",s),t.push("A",i,i,0,0,1,a),n.setMarker(h),h.dot.fill(o),n.setPathData(t),u&&u.getConnection()&&(e=u.getConnection(),s=u.getLayoutBox(),i=new c.Point(s.cx,s.cy),n=Math.sqrt(Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2)),(t=[]).push("M",a),t.push("A",n,n,0,0,1,i),e.setMarker(h),h.dot.fill(o),e.setPathData(t))})}},2:{value:function(e,t,n){m.r(17);m.r(11).register("bezier",function(e,t,n){var r=t.getLayoutVertexOut(),e=e.getLayoutVertexIn(),t=t.getLayoutVectorOut().normalize(),o=Math.round,i=Math.abs,a=[];a.push("M",o(r.x),o(r.y)),i(t.x)>i(t.y)?(o=(e.x+r.x)/2,a.push("C",o,r.y,o,e.y,e.x,e.y)):(i=(e.y+r.y)/2,a.push("C",r.x,i,e.x,i,e.x,e.y)),n.setMarker(null),n.setPathData(a)})}},3:{value:function(e,t,n){m.r(17);m.r(11).register("fish-bone-master",function(e,t,n){var t=t.getLayoutVertexOut(),e=e.getLayoutVertexIn(),r=Math.abs,o=r(t.y-e.y),r=r(t.x-e.x),i=[];i.push("M",t.x,t.y),i.push("h",r-o),i.push("L",e.x,e.y),n.setMarker(null),n.setPathData(i)})}},4:{value:function(e,t,n){m.r(17);m.r(11).register("l",function(e,t,n){var r=t.getLayoutVertexOut(),e=e.getLayoutVertexIn(),t=t.getLayoutVectorOut(),o=[],i=Math.round,a=Math.abs;o.push("M",r.round()),a(t.x)>a(t.y)?o.push("H",i(e.x)):o.push("V",e.y),o.push("L",e),n.setPathData(o)})}},5:{value:function(e,t,n){m.r(17);m.r(11).register("poly",function(e,t,n,r){var o=t.getLayoutVertexOut(),i=e.getLayoutVertexIn(),e=t.getLayoutVectorOut().normalize(),a=Math.round,s=Math.abs,u=[];switch(u.push("M",a(o.x),a(o.y)),!0){case s(e.x)>s(e.y)&&e.x<0:u.push("h",-t.getStyle("margin-left")),u.push("v",i.y-o.y),u.push("H",i.x);break;case s(e.x)>s(e.y)&&0<=e.x:u.push("h",t.getStyle("margin-right")),u.push("v",i.y-o.y),u.push("H",i.x);break;case s(e.x)<=s(e.y)&&e.y<0:u.push("v",-t.getStyle("margin-top")),u.push("h",i.x-o.x),u.push("V",i.y);break;case s(e.x)<=s(e.y)&&0<=e.y:u.push("v",t.getStyle("margin-bottom")),u.push("h",i.x-o.x),u.push("V",i.y)}n.setMarker(null),n.setPathData(u)})}},6:{value:function(e,t,n){var l=m.r(17);m.r(11).register("under",function(e,t,n,r,o){var i,a,s=e.getLayoutBox(),u=t.getLayoutBox(),c=(Math.abs,[]),h=s.x>u.x?"right":"left",e=(e.getStyle("connect-radius"),s.bottom+3),t="sub"==t.getType()?u.bottom+3:u.cy,h="right"==h?(i=new l.Point(u.right,t),a=new l.Point(s.left-10,e),new l.Point(s.right,e)):(i=new l.Point(u.left,t),a=new l.Point(s.right+10,e),new l.Point(s.left,e)),u=(i.x+a.x)/2;c.push("M",i),c.push("C",u,i.y,u,a.y,a),c.push("L",h),n.setMarker(null),n.setPathData(c)})}},7:{value:function(e,t,n){var r,o=m.r(17),i=m.r(19);-1!=location.href.indexOf("boxv")&&(Object.defineProperty(o.Box.prototype,"visualization",{get:function(){return r?r.setBox(this):null}}),i.registerInitHook(function(){this.on("paperrender",function(){(r=new o.Rect).fill("rgba(200, 200, 200, .5)"),r.stroke("orange"),this.getRenderContainer().addShape(r)})}))}},8:{value:function(e,t,n){var r=m.r(19),o={enableAnimation:!0,layoutAnimationDuration:300,viewAnimationDuration:100,zoomAnimationDuration:300},i={};r.registerInitHook(function(){this.setDefaultOptions(o),this.getOption("enableAnimation")||this.disableAnimation()}),r.prototype.enableAnimation=function(){for(var e in o)o.hasOwnProperty(e)&&this.setOption(i[e])},r.prototype.disableAnimation=function(){for(var e in o)o.hasOwnProperty(e)&&(i[e]=this.getOption(e),this.setOption(e,0))}}},9:{value:function(e,t,n){var r=m.r(17),o=(m.r(33),m.r(19)),a=(m.r(21),m.r(13)),i=r.createClass("Command",{constructor:function(){this._isContentChange=!0,this._isSelectionChange=!1},execute:function(e,t){throw new Error("Not Implement: Command.execute()")},setContentChanged:function(e){this._isContentChange=!!e},isContentChanged:function(){return this._isContentChange},setSelectionChanged:function(e){this._isSelectionChange=!!e},isSelectionChanged:function(){return this._isContentChange},queryState:function(e){return 0},queryValue:function(e){return 0},isNeedUndo:function(){return!0}});i.STATE_NORMAL=0,i.STATE_ACTIVE=1,i.STATE_DISABLED=-1,r.extendClass(o,{_getCommand:function(e){return this._commands[e.toLowerCase()]},_queryCommand:function(e,t,n){e=this._getCommand(e);if(e){t=e["query"+t];if(t)return t.apply(e,[this].concat(n))}return 0},queryCommandState:function(e){return this._queryCommand(e,"State",[].slice.call(arguments,1))},queryCommandValue:function(e){return this._queryCommand(e,"Value",[].slice.call(arguments,1))},execCommand:function(e){if(!e)return null;e=e.toLowerCase();var t,n=[].slice.call(arguments,1),r=this,o=this._getCommand(e),i={command:o,commandName:e.toLowerCase(),commandArgs:n};return!(!o||!~this.queryCommandState(e))&&(this._hasEnterExecCommand?(t=o.execute.apply(o,[r].concat(n)),this._hasEnterExecCommand||this._interactChange()):(this._hasEnterExecCommand=!0,this._fire(new a("beforeExecCommand",i,!0))||(this._fire(new a("preExecCommand",i,!1)),t=o.execute.apply(o,[r].concat(n)),this._fire(new a("execCommand",i,!1)),o.isContentChanged()&&this._firePharse(new a("contentchange")),this._interactChange()),this._hasEnterExecCommand=!1),this._fire(new a("afterExecCommand",i,!1)),void 0===t?null:t)}}),n.exports=i}}};m[10]={value:function(e,t,n){m.r(33);function r(e,t){t(e),e.children&&e.children.forEach(function(e){r(e,t)})}return function(e){switch(e.version||(e.root?"1.4.0":"1.1.3")){case"1.1.3":var t=e,n=t.data.currentstyle;delete t.data.currentstyle,"bottom"==n?(t.template="structure",t.theme="snow"):"default"==n&&(t.template="default",t.theme="classic"),r(t,function(e){e=e.data;"PriorityIcon"in e&&(e.priority=e.PriorityIcon,delete e.PriorityIcon),"ProgressIcon"in e&&(e.progress=1+(e.ProgressIcon-1<<1),delete e.ProgressIcon),delete e.point,delete e.layout});case"1.2.0":case"1.2.1":r(e,function(e){e=e.data;delete e.layout_bottom_offset,delete e.layout_default_offset,delete e.layout_filetree_offset});case"1.3.0":case"1.3.1":case"1.3.2":case"1.3.3":case"1.3.4":case"1.3.5":(n=e).root={data:n.data,children:n.children},delete n.data,delete n.children}return e}}},m[11]={value:function(e,t,n){var r=m.r(17),o=m.r(33),i=m.r(20),a=m.r(19),s=m.r(21),u={};function c(e,t){u[e]=t}c("default",function(e,t,n){n.setPathData(["M",t.getLayoutVertexOut(),"L",e.getLayoutVertexIn()])}),r.extendClass(s,{getConnect:function(){return this.data.connect||"default"},getConnectProvider:function(){return u[this.getConnect()]||u.default},getConnection:function(){return this._connection||null}}),r.extendClass(a,{getConnectContainer:function(){return this._connectContainer},createConnect:function(e){var t;e.isRoot()||(t=new r.Path,e._connection=t,this._connectContainer.addShape(t),this.updateConnect(e))},removeConnect:function(e){var t=this;e.traverse(function(e){t._connectContainer.removeShape(e._connection),e._connection=null})},updateConnect:function(e){var t,n,r,o=e._connection,i=e.parent;i&&o&&(i.isCollapsed()?o.setVisible(!1):(o.setVisible(!0),t=e.getConnectProvider(),n=e.getStyle("connect-color")||"white",r=e.getStyle("connect-width")||2,o.stroke(n,r),t(e,i,o,r,n),r%2==0?o.setTranslate(.5,.5):o.setTranslate(0,0)))}}),i.register("Connect",{init:function(){this._connectContainer=(new r.Group).setId(o.uuid("minder_connect_group")),this.getRenderContainer().prependShape(this._connectContainer)},events:{nodeattach:function(e){this.createConnect(e.node)},nodedetach:function(e){this.removeConnect(e.node)},"layoutapply layoutfinish noderender":function(e){this.updateConnect(e.node)}}}),t.register=c}},m[12]={value:function(e,t,n){var r=m.r(17),o=(m.r(33),m.r(19)),i=(m.r(21),m.r(13)),a=m.r(10),s=m.r(25),u={};t.registerProtocol=function(e,t){for(var n in u[e]=t,u)u.hasOwnProperty(n)&&(u[n].name=n)},t.getRegisterProtocol=function(e){return void 0===e?u:u[e]||null},r.extendClass(o,{setup:function(e){var t,n;if(e="string"==typeof e?document.querySelector(e):e)return(t=e.getAttribute("minder-data-type"))in u&&(n=e.textContent,e.textContent=null,this.renderTo(e),this.importData(t,n)),this},exportJson:function(){var e={root:function e(t){var n={},r=(n.data=t.getData(),t.getChildren());n.children=[];for(var o=0;o<r.length;o++)n.children.push(e(r[o]));return n}(this.getRoot())};return e.template=this.getTemplate(),e.theme=this.getTheme(),e.version=o.version,JSON.parse(JSON.stringify(e))},Text2Children:function(e,t){if(e instanceof kityminder.Node){for(var n,r,o=[],i={},a=/^(\t|\x20{4})/,s=t.split(/\r|\n|\r\n/),u="",c=0,h=this;void 0!==(u=s[c++]);)if(u=u.replace(/&nbsp;/g,""),""!==(r=u)||/\S/.test(r))if(r=function(e){for(var t=0;a.test(e);)e=e.replace(a,""),t++;return t}(u),n={data:{text:u.replace(/^(\t|\x20{4})+/,"").replace(/(\t|\x20{4})+$/,"")},children:[]},0===r)i={},o.push(n),i[0]=o[o.length-1];else{if(!i[r-1])throw new Error("Invalid local format");i[r-1].children.push(n),i[r]=n}!function e(t,n){for(var r=0,o=n.length;r<o;r++){var i=h.createNode(null,t);i.setData("text",n[r].data.text||""),e(i,n[r].children)}}(e,o),h.refresh()}},exportNode:function(e){var t={},n=(t.data=e.getData(),e.getChildren());t.children=[];for(var r=0;r<n.length;r++)t.children.push(this.exportNode(n[r]));return t},importNode:function(e,t){var n,r=t.data;for(n in e.data={},r)e.setData(n,r[n]);for(var o=t.children||[],i=0;i<o.length;i++){var a=this.createNode(null,e);this.importNode(a,o[i])}return e},importJson:function(e){if(e){for(this._fire(new i("preimport",null,!1));this._root.getChildren().length;)this.removeNode(this._root.getChildren()[0]);return e=a(e),this.importNode(this._root,e.root),this.setTemplate(e.template||"default"),this.setTheme(e.theme||null),this.refresh(),this.fire("import"),this._firePharse({type:"contentchange"}),this._interactChange(),this}},exportData:function(e,t){var n,r=this.exportJson();return!e||(n=u[e])&&n.encode?(this._fire(new i("beforeexport",{json:r,protocolName:e,protocol:n})),s.resolve(n.encode(r,this,t))):s.reject(new Error("Not supported protocol:"+e))},importData:function(e,t,n){var r,o=this;return!e||(r=u[e])&&r.decode?(this._fire(new i("beforeimport",{local:t,protocolName:e,protocol:r})),s.resolve(r.decode(t,this,n)).then(function(e){return o.importJson(e),e})):s.reject(new Error("Not supported protocol:"+e))},decodeData:function(e,t,n){var r;return!e||(r=u[e])&&r.decode?(this._fire(new i("beforeimport",{local:t,protocolName:e,protocol:r})),s.resolve(r.decode(t,this,n))):s.reject(new Error("Not supported protocol:"+e))}})}},m[13]={value:function(e,t,n){var r=m.r(17),o=(m.r(33),m.r(19)),i=r.createClass("MindEvent",{constructor:function(e,t,n){(t=t||{}).getType&&"ShapeEvent"==t.getType()?(this.kityEvent=t,this.originEvent=t.originEvent):t.target&&t.preventDefault?this.originEvent=t:r.Utils.extend(this,t),this.type=e,this._canstop=n||!1},getPosition:function(e){if(this.kityEvent)return e&&"minder"!=e?this.kityEvent.getPosition.call(this.kityEvent,e):this.kityEvent.getPosition(this.minder.getRenderContainer())},getTargetNode:function(){var e=this.kityEvent&&this.kityEvent.targetShape;if(!e)return null;for(;!e.minderNode&&e.container;)e=e.container;var t=e.minderNode;return!(t&&e.getOpacity()<1)&&t||null},stopPropagation:function(){this._stoped=!0},stopPropagationImmediately:function(){this._immediatelyStoped=!0,this._stoped=!0},shouldStopPropagation:function(){return this._canstop&&this._stoped},shouldStopPropagationImmediately:function(){return this._canstop&&this._immediatelyStoped},preventDefault:function(){this.originEvent.preventDefault()},isRightMB:function(){var e=!1;return!!this.originEvent&&("which"in this.originEvent?e=3==this.originEvent.which:"button"in this.originEvent&&(e=2==this.originEvent.button),e)},getKeyCode:function(){var e=this.originEvent;return e.keyCode||e.which}});o.registerInitHook(function(e){this._initEvents()}),r.extendClass(o,{_initEvents:function(){this._eventCallbacks={}},_resetEvents:function(){this._initEvents(),this._bindEvents()},_bindEvents:function(){this._paper.on("click dblclick mousedown contextmenu mouseup mousemove mouseover mousewheel DOMMouseScroll touchstart touchmove touchend dragenter dragleave drop",this._firePharse.bind(this)),window&&window.addEventListener("resize",this._firePharse.bind(this))},dispatchKeyEvent:function(e){this._firePharse(e)},_firePharse:function(e){var t,n;"DOMMouseScroll"==e.type&&(e.type="mousewheel",e.wheelDelta=e.originEvent.wheelDelta=-10*e.originEvent.detail,e.wheelDeltaX=e.originEvent.mozMovementX,e.wheelDeltaY=e.originEvent.mozMovementY),t=new i("before"+e.type,e,!0),!this._fire(t)&&(t=new i("pre"+e.type,e,!0),n=new i(e.type,e,!0),this._fire(t)||this._fire(n))&&this._fire(new i("after"+e.type,e,!1))},_interactChange:function(e){var t=this;t._interactScheduled||(setTimeout(function(){t._fire(new i("interactchange")),t._interactScheduled=!1},100),t._interactScheduled=!0)},_listen:function(e,t){(this._eventCallbacks[e]||(this._eventCallbacks[e]=[])).push(t)},_fire:function(e){var t=(e.minder=this).getStatus(),n=this._eventCallbacks[e.type.toLowerCase()]||[];if(0!==(n=t?n.concat(this._eventCallbacks[t+"."+e.type.toLowerCase()]||[]):n).length){this.getStatus();for(var r=0;r<n.length&&(n[r].call(this,e),!e.shouldStopPropagationImmediately());r++);return e.shouldStopPropagation()}},on:function(e,t){var n=this;return e.split(/\s+/).forEach(function(e){n._listen(e.toLowerCase(),t)}),this},once:function(e,n){var r=this;return e.split(/\s+/).forEach(function(t){r._listen(t.toLowerCase(),function(e){n(e),r.off(t.toLowerCase(),arguments.callee)})}),this},off:function(e,t){for(var n,r,o,i=e.split(/\s+/),a=0;a<i.length;a++)if(r=this._eventCallbacks[i[a].toLowerCase()]){for(o=null,n=0;n<r.length;n++)r[n]==t&&(o=n);null!==o&&r.splice(o,1)}},fire:function(e,t){e=new i(e,t);return this._fire(e),this}}),n.exports=i}},m[14]={value:function(e,t,n){var r=m.r(17),o=m.r(19);o.registerInitHook(function(){this.on("beforemousedown",function(e){this.focus(),e.preventDefault()}),this.on("paperrender",function(){this.focus()})}),r.extendClass(o,{focus:function(){return this.isFocused()||(this._renderTarget.classList.add("focus"),this.renderNodeBatch(this.getSelectedNodes())),this.fire("focus"),this},blur:function(){return this.isFocused()&&(this._renderTarget.classList.remove("focus"),this.renderNodeBatch(this.getSelectedNodes())),this.fire("blur"),this},isFocused:function(){var e=this._renderTarget;return e&&e.classList.contains("focus")}})}},m[15]={value:function(e,t,n){var r,o={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Insert:45,Left:37,Up:38,Right:39,Down:40,direction:{37:1,38:1,39:1,40:1},Del:46,NumLock:144,Cmd:91,CmdFF:224,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"`":192,"=":187,"-":189,"/":191,".":190,controlKeys:{16:1,17:1,18:1,20:1,91:1,224:1},notContentChange:{13:1,9:1,33:1,34:1,35:1,36:1,16:1,17:1,18:1,20:1,91:1,37:1,38:1,39:1,40:1,113:1,114:1,115:1,144:1,27:1},isSelectedNodeKey:{37:1,38:1,39:1,40:1,13:1,9:1}};for(r in o)o.hasOwnProperty(r)&&(o[r.toLowerCase()]=o[r]);for(var i="a".charCodeAt(0),a=("abcdefghijklmnopqrstuvwxyz".split("").forEach(function(e){o[e]=e.charCodeAt(0)-i+65}),9);o[a.toString()]=a+48,--a;);n.exports=o}},m[16]={value:function(e,t,n){var r=m.r(17),o=(m.r(33),m.r(19));o.registerInitHook(function(e){this.setDefaultOptions({enableKeyReceiver:!0}),this.getOption("enableKeyReceiver")&&this.on("paperrender",function(){this._initKeyReceiver()})}),r.extendClass(o,{_initKeyReceiver:function(){var t,n,r,o;this._keyReceiver||((t=this._keyReceiver=document.createElement("input")).classList.add("km-receiver"),this._renderTarget.appendChild(t),n=this,r=t,o=function(e){switch(e.type){case"blur":n.blur();break;case"focus":n.focus();break;case"input":t.value=null}n._firePharse(e),e.preventDefault()},"keydown keyup keypress copy paste blur focus input".split(" ").forEach(function(e){r.addEventListener(e,o,!1)}),this.on("focus",function(){t.select(),t.focus()}),this.on("blur",function(){t.blur()}),this.isFocused()&&(t.select(),t.focus()))}})}},m[17]={value:function(e,t,n){n.exports=window.kity}},m[18]={value:function(e,t,n){var r,h=m.r(17),o=m.r(33),i=m.r(19),a=m.r(21),s=(m.r(13),m.r(9),{});var u=h.createClass("Layout",{doLayout:function(e,t){throw new Error("Not Implement: Layout.doLayout()")},align:function(e,r,o){var i=this;o=o||0,e.forEach(function(e){var t=i.getTreeBox([e]),n=e.getLayoutTransform();switch(r){case"left":return n.translate(o-t.left,0);case"right":return n.translate(o-t.right,0);case"top":return n.translate(0,o-t.top);case"bottom":return n.translate(0,o-t.bottom)}})},stack:function(e,a,s){var u=this,c=0;return s=s||function(e,t,n){return e.getStyle({x:"margin-right",y:"margin-bottom"}[n])+t.getStyle({x:"margin-left",y:"margin-top"}[n])},e.forEach(function(e,t,n){var r=u.getTreeBox([e]),o={x:r.width,y:r.height}[a],r={x:r.left,y:r.top}[a],i=e.getLayoutTransform();"x"==a?i.translate(c-r,0):i.translate(0,c-r),c+=o,n[t+1]&&(c+=s(e,n[t+1],a))}),c},move:function(e,t,n){e.forEach(function(e){e.getLayoutTransform().translate(t,n)})},getBranchBox:function(e){for(var t,n,r=new h.Box,o=0;o<e.length;o++)t=(n=e[o]).getLayoutTransform(),n=n.getContentBox(),r=r.merge(t.transformBox(n));return r},getTreeBox:function(e){var t,n,r,o,i=new h.Box;for(e instanceof Array||(e=[e]),t=0;t<e.length;t++)r=(n=e[t]).getLayoutTransform(),o=n.getContentBox(),n.isExpanded()&&n.children.length&&(o=o.merge(this.getTreeBox(n.children))),i=i.merge(r.transformBox(o));return i},getOrderHint:function(e){return[]}});u.register=function(e,t){s[e]=t,r=r||e},i.registerInitHook(function(e){this.refresh()}),o.extend(i,{getLayoutList:function(){return s},getLayoutInstance:function(e){var t=s[e];if(t)return new t;throw new Error("Missing Layout: "+e)}}),h.extendClass(a,{getLayout:function(){return this.getData("layout")||(this.isRoot()?r:this.parent.getLayout())},setLayout:function(e){return e&&("inherit"==e?this.setData("layout"):this.setData("layout",e)),this},layout:function(e){return this.setLayout(e).getMinder().layout(),this},getLayoutInstance:function(){return i.getLayoutInstance(this.getLayout())},getOrderHint:function(e){return this.parent.getLayoutInstance().getOrderHint(this)},getLayoutTransform:function(){return this._layoutTransform||new h.Matrix},getGlobalLayoutTransformPreview:function(){var e=this.parent?this.parent.getLayoutTransform():new h.Matrix,t=this.getLayoutTransform(),n=this.getLayoutOffset();return n&&(t=t.clone().translate(n.x,n.y)),e.merge(t)},getLayoutPointPreview:function(){return this.getGlobalLayoutTransformPreview().transformPoint(new h.Point)},getGlobalLayoutTransform:function(){return this._globalLayoutTransform||(this.parent?this.parent.getGlobalLayoutTransform():new h.Matrix)},setLayoutTransform:function(e){return this._layoutTransform=e,this},setGlobalLayoutTransform:function(e){return this.getRenderContainer().setMatrix(this._globalLayoutTransform=e),this},setVertexIn:function(e){this._vertexIn=e},setVertexOut:function(e){this._vertexOut=e},getVertexIn:function(){return this._vertexIn||new h.Point},getVertexOut:function(){return this._vertexOut||new h.Point},getLayoutVertexIn:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexIn())},getLayoutVertexOut:function(){return this.getGlobalLayoutTransform().transformPoint(this.getVertexOut())},setLayoutVectorIn:function(e){return this._layoutVectorIn=e,this},setLayoutVectorOut:function(e){return this._layoutVectorOut=e,this},getLayoutVectorIn:function(){return this._layoutVectorIn||new h.Vector},getLayoutVectorOut:function(){return this._layoutVectorOut||new h.Vector},getLayoutBox:function(){return this.getGlobalLayoutTransform().transformBox(this.getContentBox())},getLayoutPoint:function(){return this.getGlobalLayoutTransform().transformPoint(new h.Point)},getLayoutOffset:function(){var e;return this.parent&&(e=this.getData("layout_"+this.parent.getLayout()+"_offset"))?new h.Point(e.x,e.y):new h.Point},setLayoutOffset:function(e){return this.parent&&this.setData("layout_"+this.parent.getLayout()+"_offset",e?{x:e.x,y:e.y}:void 0),this},hasLayoutOffset:function(){return!!this.getData("layout_"+this.parent.getLayout()+"_offset")},resetLayoutOffset:function(){return this.setLayoutOffset(null)},getLayoutRoot:function(){return this.isLayoutRoot()?this:this.parent.getLayoutRoot()},isLayoutRoot:function(){return this.getData("layout")||this.isRoot()}}),h.extendClass(i,{layout:function(){var e=this.getOption("layoutAnimationDuration");function n(e,t){e.isExpanded(),e.children.forEach(function(e){n(e,t)}),e.getLayoutInstance().doLayout(e,e.getChildren(),t)}this.getRoot().traverse(function(e){e.setLayoutTransform(null)}),n(this.getRoot(),1),n(this.getRoot(),2);var t=this;return this.applyLayoutResult(this.getRoot(),e,function(){setTimeout(function(){t.fire("layoutallfinish")},0)}),this.fire("layout")},refresh:function(){return this.getRoot().renderTree(),this.layout().fire("contentchange")._interactChange(),this},applyLayoutResult:function(e,a,t){e=e||this.getRoot();var s=this,n=e.getComplex();function u(){--n||t&&t()}function c(e,t){e.setGlobalLayoutTransform(t),s.fire("layoutapply",{node:e,matrix:t})}return 200<n&&(a=0),function e(t,n){var r=t.getLayoutTransform().merge(n.clone()),n=t.getGlobalLayoutTransform()||new h.Matrix,o=t.getLayoutOffset();r.translate(o.x,o.y),r.m.e=Math.round(r.m.e),r.m.f=Math.round(r.m.f),t._layoutTimeline&&(t._layoutTimeline.stop(),t._layoutTimeline=null),a?t._layoutTimeline=new h.Animator(n,r,c).start(t,a,"ease").on("finish",function(){setTimeout(function(){c(t,r),s.fire("layoutfinish",{node:t,matrix:r}),u()},150)}):(c(t,r),s.fire("layoutfinish",{node:t,matrix:r}),u());for(var i=0;i<t.children.length;i++)e(t.children[i],r)}(e,e.parent?e.parent.getGlobalLayoutTransform():new h.Matrix),this}}),n.exports=u}},m[19]={value:function(e,t,n){var r=m.r(17),o=m.r(33),i=[],r=r.createClass("Minder",{constructor:function(e){this._options=o.extend({},e);for(var t,n=i.slice();n.length;)"function"==typeof(t=n.shift())&&t.call(this,this._options);this.fire("finishInitHook")}});r.version="1.4.43",r.registerInitHook=function(e){i.push(e)},n.exports=r}},m[20]={value:function(e,t,n){var r=m.r(17),c=m.r(33),o=m.r(19),h={};t.register=function(e,t){h[e]=t},o.registerInitHook(function(){this._initModules()}),r.extendClass(o,{_initModules:function(){for(var e,t,n,r,o,i,a=h,s=this._options.modules||c.keys(a),u=(this._commands={},this._query={},this._modules={},this._rendererClasses={},0);u<s.length;u++)if(a[e=s[u]]&&(n="function"==typeof a[e]?a[e].call(this):a[e],this._modules[e]=n)){for(e in n.defaultOptions&&this.setDefaultOptions(n.defaultOptions),n.init&&n.init.call(this,this._options),r=n.commands)this._commands[e.toLowerCase()]=new r[e];if(o=n.events)for(t in o)this.on(t,o[t]);if(i=n.renderers)for(t in i)this._rendererClasses[t]=this._rendererClasses[t]||[],c.isArray(i[t])?this._rendererClasses[t]=this._rendererClasses[t].concat(i[t]):this._rendererClasses[t].push(i[t]);n.commandShortcutKeys&&this.addCommandShortcutKeys(n.commandShortcutKeys)}},_garbage:function(){for(this.clearSelect();this._root.getChildren().length;)this._root.removeChild(0)},destroy:function(){var e,t=this._modules;for(e in this._resetEvents(),this._garbage(),t)t[e].destroy&&t[e].destroy.call(this)},reset:function(){var e,t=this._modules;for(e in this._garbage(),t)t[e].reset&&t[e].reset.call(this)}})}},m[21]={value:function(e,t,n){var r=m.r(17),o=m.r(33),i=m.r(19),a=r.createClass("MinderNode",{constructor:function(e){this.parent=null,(this.root=this).children=[],this.data={id:o.guid(),created:+new Date},this.initContainers(),o.isString(e)?this.setText(e):o.isObject(e)&&o.extend(this.data,e)},initContainers:function(){this.rc=(new r.Group).setId(o.uuid("minder_node")),this.rc.minderNode=this},isRoot:function(){return this.root===this},isLeaf:function(){return 0===this.children.length},getRoot:function(){return this.root||this},getParent:function(){return this.parent},getSiblings:function(){var e=this.parent.children,t=[],n=this;return e.forEach(function(e){e!=n&&t.push(e)}),t},getLevel:function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},getComplex:function(){var e=0;return this.traverse(function(){e++}),e},getType:function(e){return this.type=["root","main","sub"][Math.min(this.getLevel(),2)],this.type},isAncestorOf:function(e){for(var t=e.parent;t;){if(t==this)return!0;t=t.parent}return!1},getData:function(e){return e?this.data[e]:this.data},setData:function(e,t){if("object"==typeof e){var n=e;for(e in n)n.hasOwnProperty(e)&&(this.data[e]=n[e])}else this.data[e]=t;return this},setText:function(e){return this.data.text=e},getText:function(){return this.data.text||null},preTraverse:function(e,t){var n=this.getChildren();t||e(this);for(var r=0;r<n.length;r++)n[r].preTraverse(e)},postTraverse:function(e,t){for(var n=this.getChildren(),r=0;r<n.length;r++)n[r].postTraverse(e);t||e(this)},traverse:function(e,t){return this.postTraverse(e,t)},getChildren:function(){return this.children},getIndex:function(){return this.parent?this.parent.children.indexOf(this):-1},insertChild:function(e,t){void 0===t&&(t=this.children.length),e.parent&&e.parent.removeChild(e),e.parent=this,e.root=this.root,this.children.splice(t,0,e)},appendChild:function(e){return this.insertChild(e)},prependChild:function(e){return this.insertChild(e,0)},removeChild:function(e){var t=e;0<=(t=e instanceof a?this.children.indexOf(e):t)&&((e=this.children.splice(t,1)[0]).parent=null,e.root=e)},clearChildren:function(){this.children=[]},getChild:function(e){return this.children[e]},getRenderContainer:function(){return this.rc},getCommonAncestor:function(e){return a.getCommonAncestor(this,e)},contains:function(e){return this==e||this.isAncestorOf(e)},clone:function(){var t=new a;return t.data=o.clone(this.data),this.children.forEach(function(e){t.appendChild(e.clone())}),t},compareTo:function(e){if(!o.comparePlainObject(this.data,e.data))return!1;if(!o.comparePlainObject(this.temp,e.temp))return!1;if(this.children.length!=e.children.length)return!1;for(var t=0;this.children[t];){if(!this.children[t].compareTo(e.children[t]))return!1;t++}return!0},getMinder:function(){return this.getRoot().minder}});a.getCommonAncestor=function(e,t){if(e instanceof Array)return a.getCommonAncestor.apply(this,e);switch(arguments.length){case 1:return e.parent||e;case 2:if(e.isAncestorOf(t))return e;if(t.isAncestorOf(e))return t;for(var n=e.parent;n&&!n.isAncestorOf(t);)n=n.parent;return n;default:return Array.prototype.reduce.call(arguments,function(e,t){return a.getCommonAncestor(e,t)},e)}},r.extendClass(i,{getRoot:function(){return this._root},setRoot:function(e){(this._root=e).minder=this},getAllNode:function(){var t=[];return this.getRoot().traverse(function(e){t.push(e)}),t},getNodeById:function(e){return this.getNodesById([e])[0]},getNodesById:function(t){var e=this.getAllNode(),n=[];return e.forEach(function(e){-1!=t.indexOf(e.getData("id"))&&n.push(e)}),n},createNode:function(e,t,n){e=new a(e);return this.fire("nodecreate",{node:e,parent:t,index:n}),this.appendNode(e,t,n),e},appendNode:function(e,t,n){return t&&t.insertChild(e,n),this.attachNode(e),this},removeNode:function(e){e.parent&&(e.parent.removeChild(e),this.detachNode(e),this.fire("noderemove",{node:e}))},attachNode:function(e){var t=this.getRenderContainer();e.traverse(function(e){e.attached=!0,t.addShape(e.getRenderContainer())}),t.addShape(e.getRenderContainer()),this.fire("nodeattach",{node:e})},detachNode:function(e){var t=this.getRenderContainer();e.traverse(function(e){e.attached=!1,t.removeShape(e.getRenderContainer())}),this.fire("nodedetach",{node:e})},getMinderTitle:function(){return this.getRoot().getText()}}),n.exports=a}},m[22]={value:function(e,t,n){var r=m.r(17),o=m.r(33),i=m.r(19);i.registerInitHook(function(e){this._defaultOptions={}}),r.extendClass(i,{setDefaultOptions:function(e){return o.extend(this._defaultOptions,e),this},getOption:function(e){return e?(e in this._options?this._options:this._defaultOptions)[e]:o.extend({},this._defaultOptions,this._options)},setOption:function(e,t){this._options[e]=t}})}},m[23]={value:function(e,t,n){var r=m.r(17),o=m.r(33),i=m.r(19);i.registerInitHook(function(){this._initPaper()}),r.extendClass(i,{_initPaper:function(){this._paper=new r.Paper,(this._paper._minder=this)._paper.getNode().ondragstart=function(e){e.preventDefault()},this._paper.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),this._addRenderContainer(),this.setRoot(this.createNode()),this._options.renderTo&&this.renderTo(this._options.renderTo)},_addRenderContainer:function(){this._rc=(new r.Group).setId(o.uuid("minder")),this._paper.addShape(this._rc)},renderTo:function(e){var t;return(e="string"==typeof e?document.querySelector(e):e)&&("script"==e.tagName.toLowerCase()&&((t=document.createElement("div")).id=e.id,t.class=e.class,e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e),e=t),e.classList.add("km-view"),this._paper.renderTo(this._renderTarget=e),this._bindEvents(),this.fire("paperrender")),this},getRenderContainer:function(){return this._rc},getPaper:function(){return this._paper},getRenderTarget:function(){return this._renderTarget}})}},m[24]={value:function(e,t,n){var r=m.r(17),o=m.r(19);function i(e,t){var n;if((c=t.path.split("/")).shift(),"root"==(r=c.shift())){var r,o,i,a=c.indexOf("data");for(-1<a?(r="data",a=c.splice(a+1),t.dataPath=a):r="node",n=e.getRoot();o=c.shift();)"children"!=o&&(void 0!==i&&(n=n.getChild(i)),i=+o);t.index=i,t.node=n}switch(t.express=[r,t.op].join(".")){case"theme.replace":e.useTheme(t.value);break;case"template.replace":e.useTemplate(t.value);break;case"node.add":!function n(r,e,o,t){return o=r.createNode(e.data,o,t),e.children.forEach(function(e,t){n(r,e,o,t)}),o}(e,t.value,t.node,t.index).renderTree(),e.layout();break;case"node.remove":e.removeNode(t.node.getChild(t.index)),e.layout();break;case"data.add":case"data.replace":case"data.remove":for(var s,u=t.node.data,c=t.dataPath.slice();u&&1<c.length;)(s=c.shift())in u?u=u[s]:"remove"!=t.op&&(u=u[s]={});u&&(u[s=c.shift()]=t.value),"expandState"==s?n.renderTree():n.render(),e.layout()}e.fire("patch",{patch:t})}r.extendClass(o,{applyPatches:function(e){for(var t=0;t<e.length;t++)i(this,e[t]);return this.fire("contentchange"),this}})}},m[25]={value:function(e,t,n){function i(e){if(!(this instanceof i))return new i(e);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],"function"==typeof e&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))}i.prototype={fulfill:function(e){return r(this,1,"fulfillValue",e)},reject:function(e){return r(this,2,"rejectReason",e)},then:function(e,t){var n=new i;return this.onFulfilled.push(s(e,n,"fulfill")),this.onRejected.push(s(t,n,"reject")),o(this),n}},i.all=function(a){return new i(function(t,n){var r=a.length,e=0,o=0,i=[];for(0===r&&t(i);e<r;)a[e].then(function(e){i.push(e),++o===r&&t(i)},function(e){n(e)}),e++})};var r=function(e,t,n,r){return 0===e.state&&(e.state=t,e[n]=r,o(e)),e},o=function(e){1===e.state?a(e,"onFulfilled",e.fulfillValue):2===e.state&&a(e,"onRejected",e.rejectReason)},a=function(e,t,n){var r;0!==e[t].length&&(r=e[t],e[t]=[],e=function(){for(var e=0;e<r.length;e++)r[e](n)},"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(e):"function"==typeof setImmediate?setImmediate(e):setTimeout(e,0))},s=function(n,r,o){return function(e){if("function"!=typeof n)r[o].call(r,e);else{var t;try{t=e instanceof i?e.then(n):n(e)}catch(e){return void r.reject(e)}u(r,t)}}},u=function(t,n){if(t===n)t.reject(new TypeError("cannot resolve promise with itself"));else{var e;if("object"==typeof n&&null!==n||"function"==typeof n)try{e=n.then}catch(e){return void t.reject(e)}if("function"==typeof e){var r=!1;try{e.call(n,function(e){r||(r=!0,e===n?t.reject(new TypeError("circular thenable chain")):u(t,e))},function(e){r||(r=!0,t.reject(e))})}catch(e){r||t.reject(e)}}else t.fulfill(n)}};i.resolve=function(t){return new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},n.exports=i}},m[26]={value:function(e,t,n){var r=m.r(17),o=m.r(19);m.r(13);o.registerInitHook(function(e){e.readOnly&&this.setDisabled()}),r.extendClass(o,{disable:function(){var n=this;n.bkqueryCommandState=n.queryCommandState,n.bkqueryCommandValue=n.queryCommandValue,n.queryCommandState=function(e){var t=this._getCommand(e);return t&&t.enableReadOnly?n.bkqueryCommandState.apply(n,arguments):-1},n.queryCommandValue=function(e){var t=this._getCommand(e);return t&&t.enableReadOnly?n.bkqueryCommandValue.apply(n,arguments):null},this.setStatus("readonly"),n._interactChange()},enable:function(){var e=this;e.bkqueryCommandState&&(e.queryCommandState=e.bkqueryCommandState,delete e.bkqueryCommandState),e.bkqueryCommandValue&&(e.queryCommandValue=e.bkqueryCommandValue,delete e.bkqueryCommandValue),this.setStatus("normal"),e._interactChange()}})}},m[27]={value:function(e,t,n){var u=m.r(17),r=m.r(19),o=m.r(21),i=u.createClass("Renderer",{constructor:function(e){this.node=e},create:function(e){throw new Error("Not implement: Renderer.create()")},shouldRender:function(e){return!0},watchChange:function(e){void 0!==this.watchingData&&this.watchingData;this.watchingData=e},shouldDraw:function(e){return!0},update:function(e,t,n){return this.shouldDraw()&&this.draw(e,t),this.place(e,t,n)},draw:function(e,t){throw new Error("Not implement: Renderer.draw()")},place:function(e,t,n){throw new Error("Not implement: Renderer.place()")},getRenderShape:function(){return this._renderShape||null},setRenderShape:function(e){this._renderShape=e}});function c(t,r){var o=[];["center","left","right","top","bottom","outline","outside"].forEach(function(e){var t="before"+e,n="after"+e;r[t]&&(o=o.concat(r[t])),r[e]&&(o=o.concat(r[e])),r[n]&&(o=o.concat(r[n]))}),t._renderers=o.map(function(e){return new e(t)})}u.extendClass(r,{renderNodeBatch:function(e){var t,n,r,o,i,a=this._rendererClasses,s=[];if(e.length){for(r=0;r<e.length;r++)(i=e[r])._renderers||c(i,a),i._contentBox=new u.Box,this.fire("beforerender",{node:i});for(t=e[0]._renderers.length,n=0;n<t;n++){for(r=0;r<e.length;r++)"function"==typeof s[r]&&(s[r]=s[r]()),s[r]instanceof u.Box||(s[r]=new u.Box(s[r]));for(r=0;r<e.length;r++)o=(i=e[r])._renderers[n],s[r]&&(i._contentBox=i._contentBox.merge(s[r]),o.contentBox=s[r]),o.shouldRender(i)?(o.getRenderShape()||(o.setRenderShape(o.create(i)),o.bringToBack?i.getRenderContainer().prependShape(o.getRenderShape()):i.getRenderContainer().appendShape(o.getRenderShape())),o.getRenderShape().setVisible(!0),s[r]=o.update(o.getRenderShape(),i,i._contentBox)):o.getRenderShape()&&(o.getRenderShape().setVisible(!1),s[r]=null)}for(r=0;r<e.length;r++)this.fire("noderender",{node:e[r]})}},renderNode:function(t){var n,e=this._rendererClasses;t._renderers||c(t,e),this.fire("beforerender",{node:t}),t._contentBox=new u.Box,t._renderers.forEach(function(e){e.shouldRender(t)?(e.getRenderShape()||(e.setRenderShape(e.create(t)),e.bringToBack?t.getRenderContainer().prependShape(e.getRenderShape()):t.getRenderContainer().appendShape(e.getRenderShape())),e.getRenderShape().setVisible(!0),(n="function"==typeof(n=e.update(e.getRenderShape(),t,t._contentBox))?n():n)&&(t._contentBox=t._contentBox.merge(n),e.contentBox=n)):e.getRenderShape()&&e.getRenderShape().setVisible(!1)}),this.fire("noderender",{node:t})}}),u.extendClass(o,{render:function(){if(this.attached)return this.getMinder().renderNode(this),this},renderTree:function(){var t;if(this.attached)return t=[],this.traverse(function(e){t.push(e)}),this.getMinder().renderNodeBatch(t),this},getRenderer:function(e){var t=this._renderers;if(t)for(var n=0;n<t.length;n++)if(t[n].getType()==e)return t[n];return null},getContentBox:function(){return(!this.parent||!this.parent.isCollapsed())&&this._contentBox||new u.Box},getRenderBox:function(e,t){e=e&&this.getRenderer(e),e=e?e.contentBox:this.getContentBox();return u.Matrix.getCTM(this.getRenderContainer(),t||"paper").transformBox(e)}}),n.exports=i}},m[28]={value:function(e,t,n){var r=m.r(17),o=m.r(33),i=m.r(19),a=m.r(21);i.registerInitHook(function(){this._initSelection()}),r.extendClass(i,{_initSelection:function(){this._selectedNodes=[]},renderChangedSelection:function(t){var n=this.getSelectedNodes(),r=[];for(n.forEach(function(e){-1==t.indexOf(e)&&r.push(e)}),t.forEach(function(e){-1==n.indexOf(e)&&r.push(e)}),r.length&&(this._interactChange(),this.fire("selectionchange"));r.length;)r.shift().render()},getSelectedNodes:function(){return this._selectedNodes},getSelectedNode:function(){return this.getSelectedNodes()[0]||null},removeAllSelectedNodes:function(){var e=this._selectedNodes.splice(0);return this._selectedNodes=[],this.renderChangedSelection(e),this.fire("selectionclear")},removeSelectedNodes:function(e){var t=this,n=this._selectedNodes.slice(0);return(e=o.isArray(e)?e:[e]).forEach(function(e){-1!==(e=t._selectedNodes.indexOf(e))&&t._selectedNodes.splice(e,1)}),this.renderChangedSelection(n),this},select:function(e,t){var n=this.getSelectedNodes().slice(0),r=(t&&(this._selectedNodes=[]),this);return(e=o.isArray(e)?e:[e]).forEach(function(e){-1===r._selectedNodes.indexOf(e)&&r._selectedNodes.unshift(e)}),this.renderChangedSelection(n),this},selectById:function(e,t){e=o.isArray(e)?e:[e];e=this.getNodesById(e);return this.select(e,t)},toggleSelect:function(e){return o.isArray(e)?e.forEach(this.toggleSelect.bind(this)):e.isSelected()?this.removeSelectedNodes(e):this.select(e),this},isSingleSelect:function(){return 1==this._selectedNodes.length},getSelectedAncestors:function(e){var t,n=this.getSelectedNodes().slice(0),r=[],o=n.indexOf(this.getRoot());for(~o&&!e&&n.splice(o,1),n.sort(function(e,t){return e.getLevel()-t.getLevel()});t=n.pop();)!function(e,t){for(var n=e.length-1;0<=n;--n)if(e[n].isAncestorOf(t))return 1}(n,t)&&r.push(t);return r}}),r.extendClass(a,{isSelected:function(){var e=this.getMinder();return e&&-1!=e.getSelectedNodes().indexOf(this)}})}},m[29]={value:function(e,t,n){var r=m.r(17),i=m.r(33),o=m.r(15),a=m.r(19),s=m.r(13);function u(e){var t=0;return"string"==typeof e?e.toLowerCase().split(/\+\s*/).forEach(function(e){switch(e){case"ctrl":case"cmd":t|=4096;break;case"alt":t|=8192;break;case"shift":t|=16384;break;default:t|=o[e]}}):((e.ctrlKey||e.metaKey)&&(t|=4096),e.altKey&&(t|=8192),e.shiftKey&&(t|=16384),t|=e.keyCode),t}r.extendClass(s,{isShortcutKey:function(e){var t=this.originEvent;return!!t&&u(e)==u(t)}}),a.registerInitHook(function(){this._initShortcutKey()}),r.extendClass(a,{_initShortcutKey:function(){this._bindShortcutKeys()},_bindShortcutKeys:function(){var n=this._shortcutKeys={};this.on("keydown",function(e){for(var t in n)if(n.hasOwnProperty(t)&&e.isShortcutKey(t)){t=n[t];if(t.__statusCondition&&t.__statusCondition!=this.getStatus())return;t(),e.preventDefault()}})},addShortcut:function(e,n){var r=this._shortcutKeys;e.split(/\|\s*/).forEach(function(e){var t=e.split("::");1<t.length&&(e=t[1],t=t[0],n.__statusCondition=t),r[e]=n})},addCommandShortcutKeys:function(e,t){var n=this._commandShortcutKeys||(this._commandShortcutKeys={}),r={},o=(t?r[e]=t:r=e,this);i.each(r,function(e,t){n[t]=e,o.addShortcut(e,function(){-1!==o.queryCommandState(t)&&o.execCommand(t)})})},getCommandShortcutKey:function(e){var t=this._commandShortcutKeys;return t&&t[e]||null},supportClipboardEvent:!!window.ClipboardEvent})}},m[30]={value:function(e,t,n){var r=m.r(17),o=m.r(19),i=~window.location.href.indexOf("status"),a=~window.location.href.indexOf("trace");o.registerInitHook(function(){this._initStatus()}),r.extendClass(o,{_initStatus:function(){this._status="normal",this._rollbackStatus="normal"},setStatus:function(e,t){return("readonly"!=this._status||t)&&e!=this._status&&(this._rollbackStatus=this._status,this._status=e,this.fire("statuschange",{lastStatus:this._rollbackStatus,currentStatus:this._status}),i)&&(console.log(window.event.type,this._rollbackStatus,"->",this._status),a)&&console.trace(),this},rollbackStatus:function(){this.setStatus(this._rollbackStatus)},getRollbackStatus:function(){return this._rollbackStatus},getStatus:function(){return this._status}})}},m[31]={value:function(e,t,n){var r,o,i,a=m.r(17),s=m.r(33),u=m.r(19),c=m.r(9),h=m.r(21),l=m.r(20),d={};t.register=function(e,t){d[e]=t},s.extend(u,{getTemplateList:function(){return d}}),a.extendClass(u,(r=u.prototype.getTheme,{useTemplate:function(e,t){this.setTemplate(e),this.refresh(t||800)},getTemplate:function(){return this._template||"default"},setTemplate:function(e){this._template=e||null},getTemplateSupport:function(e){var t=d[this.getTemplate()];return t&&t[e]},getTheme:function(e){return(this.getTemplateSupport("getTheme")||r).call(this,e)}})),a.extendClass(h,(o=h.prototype.getLayout,i=h.prototype.getConnect,{getLayout:function(){return(this.getMinder().getTemplateSupport("getLayout")||o).call(this,this)},getConnect:function(){return(this.getMinder().getTemplateSupport("getConnect")||i).call(this,this)}})),l.register("TemplateModule",{commands:{template:a.createClass("TemplateCommand",{base:c,execute:function(e,t){e.useTemplate(t),e.execCommand("camera")},queryValue:function(e){return e.getTemplate()||"default"}})}})}},m[32]={value:function(e,t,n){var r=m.r(17),i=m.r(33),o=m.r(19),a=m.r(21),s=m.r(20),u=m.r(9),c={left:function(e){return 3 in e&&e[3]||1 in e&&e[1]||e[0]},right:function(e){return 1 in e&&e[1]||e[0]},top:function(e){return e[0]},bottom:function(e){return 2 in e&&e[2]||e[0]}},h={};t.register=function(e,t){h[e]=t},i.extend(o,{getThemeList:function(){return h}}),r.extendClass(o,{useTheme:function(e){return this.setTheme(e),this.refresh(800),!0},setTheme:function(e){if(e&&!h[e])throw new Error("Theme "+e+" not exists!");var t=this._theme,n=(this._theme=e||null,this.getRenderTarget());return n&&(n.classList.remove("km-theme-"+t),e&&n.classList.add("km-theme-"+e),n.style.background=this.getStyle("background")),this.fire("themechange",{theme:e}),this},getTheme:function(e){return this._theme||this.getOption("defaultTheme")||"fresh-blue"},getThemeItems:function(e){this.getTheme(e);return h[this.getTheme(e)]},getStyle:function(e,t){var n,r,o,t=this.getThemeItems(t);if(e in t)return t[e];if(!((r=e.split("-")).length<2)&&(n=r.pop(),(e=r.join("-"))in t)){if(r=t[e],i.isArray(r)&&(o=c[n]))return o(r);if(!isNaN(r))return r}return null},getNodeStyle:function(e,t){var n=this.getStyle(e.getType()+"-"+t,e);return null!==n?n:this.getStyle(t,e)}}),r.extendClass(a,{getStyle:function(e){return this.getMinder().getNodeStyle(this,e)}}),s.register("Theme",{defaultOptions:{defaultTheme:"fresh-blue"},commands:{theme:r.createClass("ThemeCommand",{base:u,execute:function(e,t){return e.useTheme(t)},queryValue:function(e){return e.getTheme()||"default"}})}}),o.registerInitHook(function(){this.setTheme()})}},m[33]={value:function(e,r){var t=m.r(17),n={};r.extend=t.Utils.extend.bind(t.Utils),r.each=t.Utils.each.bind(t.Utils),r.uuid=function(e){return n[e]=n[e]?n[e]+1:1,e+n[e]},r.guid=function(){return(1e6*+new Date+Math.floor(1e6*Math.random())).toString(36)},r.trim=function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},r.keys=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n},r.clone=function(e){return JSON.parse(JSON.stringify(e))},r.comparePlainObject=function(e,t){return JSON.stringify(e)==JSON.stringify(t)},r.encodeHtml=function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},r.clearWhiteSpace=function(e){return e.replace(/[\u200b\t\r\n]/g,"")},r.each(["String","Function","Array","Number","RegExp","Object"],function(t){var n=Object.prototype.toString;r["is"+t]=function(e){return n.apply(e)=="[object "+t+"]"}})}},m[34]={value:function(e,t,n){n.exports=window.kityminder=m.r(35)}},m[35]={value:function(e,t,n){var r={version:m.r(19).version};m.r(33),r.Minder=m.r(19),r.Command=m.r(9),r.Node=m.r(21),m.r(22),m.r(8),r.Event=m.r(13),r.data=m.r(12),m.r(10),r.KeyMap=m.r(15),m.r(29),m.r(30),m.r(23),m.r(28),m.r(14),m.r(16),r.Module=m.r(20),m.r(26),r.Render=m.r(27),r.Connect=m.r(11),r.Layout=m.r(18),r.Theme=m.r(32),r.Template=m.r(31),r.Promise=m.r(25),m.r(7),m.r(24),m.r(42),m.r(43),m.r(44),m.r(45),m.r(46),m.r(47),m.r(48),m.r(50),m.r(49),m.r(51),m.r(52),m.r(53),m.r(54),m.r(55),m.r(56),m.r(57),m.r(58),m.r(59),m.r(60),m.r(61),m.r(62),m.r(63),m.r(64),m.r(68),m.r(65),m.r(67),m.r(66),m.r(40),m.r(36),m.r(37),m.r(38),m.r(39),m.r(41),m.r(75),m.r(78),m.r(77),m.r(76),m.r(78),m.r(80),m.r(79),m.r(0),m.r(1),m.r(2),m.r(3),m.r(4),m.r(5),m.r(6),m.r(69),m.r(73),m.r(70),m.r(72),m.r(71),m.r(74),n.exports=r}},m[36]={value:function(e,t,n){var h=m.r(17),r=m.r(18);["left","right","top","bottom"].forEach(function(a){var s="left"==a||"right"==a?"x":"y",u="left"==a||"top"==a?-1:1,c={left:"right",right:"left",top:"bottom",bottom:"top",x:"y",y:"x"};r.register(a,h.createClass({base:r,doLayout:function(e,t){var n=e.getContentBox();if("x"==s?(e.setVertexOut(new h.Point(n[a],n.cy)),e.setLayoutVectorOut(new h.Vector(u,0))):(e.setVertexOut(new h.Point(n.cx,n[a])),e.setLayoutVectorOut(new h.Vector(0,u))),!t.length)return!1;t.forEach(function(e){var t=e.getContentBox();e.setLayoutTransform(new h.Matrix),"x"==s?(e.setVertexIn(new h.Point(t[c[a]],t.cy)),e.setLayoutVectorIn(new h.Vector(u,0))):(e.setVertexIn(new h.Point(t.cx,t[c[a]])),e.setLayoutVectorIn(new h.Vector(0,u)))}),this.align(t,c[a]),this.stack(t,c[s]);var r=this.getBranchBox(t),o=0,i=0,i="x"==s?(o=n[a],o=(o+=u*e.getStyle("margin-"+a))+u*t[0].getStyle("margin-"+c[a]),i=n.bottom,(i=(i-=n.height/2)-r.height/2)-r.y):(o=n.right,o=(o=(o-=n.width/2)-r.width/2)-r.x,i=n[a],(i+=u*e.getStyle("margin-"+a))+u*t[0].getStyle("margin-"+c[a]));this.move(t,o,i)},getOrderHint:function(e){var t=[],n=e.getLayoutBox();return"x"==s?(t.push({type:"up",node:e,area:new h.Box({x:n.x,y:n.top-e.getStyle("margin-top")-5,width:n.width,height:e.getStyle("margin-top")}),path:["M",n.x,n.top-5,"L",n.right,n.top-5]}),t.push({type:"down",node:e,area:new h.Box({x:n.x,y:n.bottom+5,width:n.width,height:e.getStyle("margin-bottom")}),path:["M",n.x,n.bottom+5,"L",n.right,n.bottom+5]})):(t.push({type:"up",node:e,area:new h.Box({x:n.left-e.getStyle("margin-left")-5,y:n.top,width:e.getStyle("margin-left"),height:n.height}),path:["M",n.left-5,n.top,"L",n.left-5,n.bottom]}),t.push({type:"down",node:e,area:new h.Box({x:n.right+5,y:n.top,width:e.getStyle("margin-right"),height:n.height}),path:["M",n.right+5,n.top,"L",n.right+5,n.bottom]})),t}}))})}},m[37]={value:function(e,t,n){var s=m.r(17),r=m.r(18);[-1,1].forEach(function(a){var e="filetree-"+(0<a?"down":"up");r.register(e,s.createClass({base:r,doLayout:function(e,t,n){var r,o,i=e.getContentBox();e.setVertexOut(new s.Point(i.left+20,0<a?i.bottom:i.top)),e.setLayoutVectorOut(new s.Vector(0,a)),t.length&&(t.forEach(function(e){var t=e.getContentBox();e.setLayoutTransform(new s.Matrix),e.setVertexIn(new s.Point(t.left,t.cy)),e.setLayoutVectorIn(new s.Vector(1,0))}),this.align(t,"left"),this.stack(t,"y"),r=(r=(r=0)+i.left+20)+t[0].getStyle("margin-left"),o=(o=0)<a?(o=(o+=i.bottom)+e.getStyle("margin-bottom"))+t[0].getStyle("margin-top"):(o=(o=(o-=this.getTreeBox(t).bottom)+i.top)-e.getStyle("margin-top"))-t[0].getStyle("margin-bottom"),this.move(t,r,o))},getOrderHint:function(e){var t=[],n=e.getLayoutBox(),r=1<e.getLevel()?3:5;return t.push({type:"up",node:e,area:new s.Box({x:n.x,y:n.top-e.getStyle("margin-top")-r,width:n.width,height:e.getStyle("margin-top")}),path:["M",n.x,n.top-r,"L",n.right,n.top-r]}),t.push({type:"down",node:e,area:new s.Box({x:n.x,y:n.bottom+r,width:n.width,height:e.getStyle("margin-bottom")}),path:["M",n.x,n.bottom+r,"L",n.right,n.bottom+r]}),t}}))})}},m[38]={value:function(e,t,n){var h=m.r(17),r=m.r(18);r.register("fish-bone-master",h.createClass("FishBoneMasterLayout",{base:r,doLayout:function(e,t,n){var r,o,i,a=[],s=[],u=t[0],c=e.getContentBox();e.setVertexOut(new h.Point(c.right,c.cy)),e.setLayoutVectorOut(new h.Vector(1,0)),u&&(u.getContentBox(),i=e.getStyle("margin-right"),r=u.getStyle("margin-left"),o=u.getStyle("margin-top"),u=u.getStyle("margin-bottom"),t.forEach(function(e,t){e.setLayoutTransform(new h.Matrix);var n=e.getContentBox();t%2?(s.push(e),e.setVertexIn(new h.Point(n.left,n.top)),e.setLayoutVectorIn(new h.Vector(1,1))):(a.push(e),e.setVertexIn(new h.Point(n.left,n.bottom)),e.setLayoutVectorIn(new h.Vector(1,-1)))}),this.stack(a,"x"),this.stack(s,"x"),this.align(a,"bottom"),this.align(s,"top"),t=c.right+i+r,i=c.cy-u-e.getStyle("margin-top"),u=c.cy+o+e.getStyle("margin-bottom"),this.move(a,t,i),this.move(s,t+r,u))}}))}},m[39]={value:function(e,t,n){var h=m.r(17),r=m.r(18);r.register("fish-bone-slave",h.createClass("FishBoneSlaveLayout",{base:r,doLayout:function(e,t,n){var r,o=this,i=Math.abs,a=e.getContentBox(),s=e.getLayoutVectorIn(),u=(e.setLayoutVectorOut(s),a.left+.382*a.width),c=new h.Point(u,0<s.y?a.bottom:a.top),u=(e.setVertexOut(c),t[0]);u&&(r=u.getContentBox(),t.forEach(function(e,t){e.setLayoutTransform(new h.Matrix),e.setLayoutVectorIn(new h.Vector(1,0)),e.setVertexIn(new h.Point(r.left,r.cy))}),this.stack(t,"y"),this.align(t,"left"),a=s=0,s+=c.x,a=e.getLayoutVectorOut().y<0?(a=(a=(a-=this.getTreeBox(t).bottom)+e.getContentBox().top)-e.getStyle("margin-top"))-u.getStyle("margin-bottom"):(a=(a+=e.getContentBox().bottom)+e.getStyle("margin-bottom"))+u.getStyle("margin-top"),this.move(t,s,a),2==n)&&t.forEach(function(e){var t=e.getLayoutTransform(),n=e.getContentBox(),t=t.transformPoint(new h.Point(n.left,0));o.move([e],i(t.y-c.y),0)})}}))}},m[40]={value:function(e,t,n){var a=m.r(17),r=m.r(18),s=m.r(19);r.register("mind",a.createClass({base:r,doLayout:function(e,t){var n=Math.ceil(e.children.length/2),r=[],o=[],t=(t.forEach(function(e){(e.getIndex()<n?r:o).push(e)}),s.getLayoutInstance("left")),i=s.getLayoutInstance("right"),t=(t.doLayout(e,o),i.doLayout(e,r),e.getContentBox());e.setVertexOut(new a.Point(t.cx,t.cy)),e.setLayoutVectorOut(new a.Vector(0,0))},getOrderHint:function(e){var t=[],n=e.getLayoutBox();return t.push({type:"up",node:e,area:new a.Box({x:n.x,y:n.top-e.getStyle("margin-top")-5,width:n.width,height:e.getStyle("margin-top")}),path:["M",n.x,n.top-5,"L",n.right,n.top-5]}),t.push({type:"down",node:e,area:new a.Box({x:n.x,y:n.bottom+5,width:n.width,height:e.getStyle("margin-bottom")}),path:["M",n.x,n.bottom+5,"L",n.right,n.bottom+5]}),t}}))}},m[41]={value:function(e,t,n){var c=m.r(17),r=m.r(18);m.r(19);r.register("tianpan",c.createClass({base:r,doLayout:function(e,t){var n,r,o,i,a,s,u;0!=t.length&&(n=this,r=e.getContentBox(),s=5,u=Math.max(r.width,50),t.forEach(function(e,t){e.setLayoutTransform(new c.Matrix),a=n.getTreeBox(e),u=Math.max(Math.max(a.width,a.height),u)}),u=u/1.5/Math.PI,t.forEach(function(e,t){o=u*(Math.cos(s)+Math.sin(s)*s),i=u*(Math.sin(s)-Math.cos(s)*s),s+=.9-.02*t,e.setLayoutVectorIn(new c.Vector(1,0)),e.setVertexIn(new c.Point(r.cx,r.cy)),e.setLayoutTransform(new c.Matrix),n.move([e],o,i)}))},getOrderHint:function(e){var t=[],n=e.getLayoutBox();return t.push({type:"up",node:e,area:{x:n.x,y:n.top-e.getStyle("margin-top")-5,width:n.width,height:e.getStyle("margin-top")},path:["M",n.x,n.top-5,"L",n.right,n.top-5]}),t.push({type:"down",node:e,area:{x:n.x,y:n.bottom+5,width:n.width,height:e.getStyle("margin-bottom")},path:["M",n.x,n.bottom+5,"L",n.right,n.bottom+5]}),t}}))}},m[42]={value:function(e,t,n){var r=m.r(17),o=m.r(21),i=m.r(9),a=m.r(20);function s(e,t){return e.getIndex()-t.getIndex()}function u(e,t){return-s(e,t)}r.extendClass(o,{arrange:function(e){var t=this.parent;if(t){t=t.children;if(!(e<0||e>=t.length))return t.splice(this.getIndex(),1),t.splice(e,0,this),this}}});var c=r.createClass("ArrangeUpCommand",{base:i,execute:function(e){var t=e.getSelectedNodes(),n=(t.sort(s),t.map(function(e){return e.getIndex()}));t.forEach(function(e,t){e.arrange(n[t]-1)}),e.layout(300)},queryState:function(e){return e.getSelectedNode()?0:-1}}),h=r.createClass("ArrangeUpCommand",{base:i,execute:function(e){var t=e.getSelectedNodes(),n=(t.sort(u),t.map(function(e){return e.getIndex()}));t.forEach(function(e,t){e.arrange(n[t]+1)}),e.layout(300)},queryState:function(e){return e.getSelectedNode()?0:-1}}),r=r.createClass("ArrangeCommand",{base:i,execute:function(e,t){var n,r=e.getSelectedNodes().slice();r.length&&o.getCommonAncestor(r)==r[0].parent&&(r=r.map(function(e){return{index:e.getIndex(),node:e}}),n=Math.min.apply(Math,r.map(function(e){return e.index}))>=t,r.sort(function(e,t){return n?t.index-e.index:e.index-t.index}),r.forEach(function(e){e.node.arrange(t)}),e.layout(300))},queryState:function(e){return e.getSelectedNode()?0:-1}});a.register("ArrangeModule",{commands:{arrangeup:c,arrangedown:h,arrange:r},contextmenu:[{command:"arrangeup"},{command:"arrangedown"},{divider:!0}],commandShortcutKeys:{arrangeup:"normal::alt+Up",arrangedown:"normal::alt+Down"}})}},m[43]={value:function(e,t,n){var r=m.r(17),i=(m.r(33),m.r(19),m.r(21),m.r(9)),o=m.r(20),a=m.r(61);o.register("basestylemodule",function(){var n=this;function o(e,t){return e.getData(t)||e.getStyle(t)}return a.registerStyleHook(function(e,t){var n=o(e,"font-weight"),r=o(e,"font-style");[n,r].join("/");t.eachItem(function(e,t){t.setFont({weight:n,style:r})})}),{commands:{bold:r.createClass("boldCommand",{base:i,execute:function(e){var t=e.getSelectedNodes();1==this.queryState("bold")?t.forEach(function(e){e.setData("font-weight").render()}):t.forEach(function(e){e.setData("font-weight","bold").render()}),e.layout()},queryState:function(){var e=n.getSelectedNodes(),t=0;return 0===e.length?-1:(e.forEach(function(e){if(e&&e.getData("font-weight"))return!(t=1)}),t)}}),italic:r.createClass("italicCommand",{base:i,execute:function(e){var t=e.getSelectedNodes();1==this.queryState("italic")?t.forEach(function(e){e.setData("font-style").render()}):t.forEach(function(e){e.setData("font-style","italic").render()}),e.layout()},queryState:function(){var e=n.getSelectedNodes(),t=0;return 0===e.length?-1:(e.forEach(function(e){if(e&&e.getData("font-style"))return!(t=1)}),t)}})},commandShortcutKeys:{bold:"ctrl+b",italic:"ctrl+i"}}})}},m[44]={value:function(e,t,n){var o=m.r(17),i=(m.r(33),m.r(21)),c=m.r(9);m.r(20).register("ClipboardModule",function(){var a=this,s=[],u=[];function n(e){e.length&&(e.sort(function(e,t){return e.getIndex()-t.getIndex()}),s=e.map(function(e){return e.clone()}))}var e=o.createClass("CopyCommand",{base:c,execute:function(e){n(e.getSelectedAncestors(!0)),this.setContentChanged(!1)}}),t=o.createClass("CutCommand",{base:c,execute:function(t){var e=t.getSelectedAncestors();0!==e.length&&(n(e),t.select(i.getCommonAncestor(e),!0),e.slice().forEach(function(e){t.removeNode(e)}),t.layout(300))}}),r=o.createClass("PasteCommand",{base:c,execute:function(e){if(s.length){var t=e.getSelectedNodes();if(t.length){for(var n,r=0;n=s[r];r++)for(var o,i=0;o=t[i];i++)!function e(t,n){u.push(n),a.appendNode(n,t),n.render(),n.setLayoutOffset(null);var r=n.children.map(function(e){return e.clone()});n.clearChildren();for(var o,i=0;o=r[i];i++)e(n,o)}(o,n.clone());e.select(u,!0),u=[],e.layout(300)}}},queryState:function(e){return e.getSelectedNode()?0:-1}});return a.supportClipboardEvent&&!o.Browser.gecko?{commands:{copy:e,cut:t,paste:r},clipBoardEvents:{copy:function(e){this.fire("beforeCopy",e)}.bind(a),cut:function(e){this.fire("beforeCut",e)}.bind(a),paste:function(e){this.fire("beforePaste",e)}.bind(a)},sendToClipboard:n}:{commands:{copy:e,cut:t,paste:r},commandShortcutKeys:{copy:"normal::ctrl+c|",cut:"normal::ctrl+x",paste:"normal::ctrl+v"},sendToClipboard:n}})}},m[45]={value:function(e,t,n){var o=m.r(17),r=(m.r(33),m.r(21)),i=m.r(9),a=m.r(20),s=o.createClass("MoveToParentCommand",{base:i,execute:function(e,t,n){for(var r,o=0;o<t.length;o++)(r=t[o]).parent&&(r.parent.removeChild(r),n.appendChild(r),r.render());n.expand(),e.select(t,!0)}}),u=o.createClass("DropHinter",{base:o.Group,constructor:function(){this.callBase2(o.Group,"constructor",[]),this.rect=new o.Rect,this.addShape(this.rect)},render:function(e){this.setVisible(!!e),e&&(this.rect.setBox(e.getLayoutBox()).setRadius(e.getStyle("radius")||0).stroke(e.getStyle("drop-hint-color")||"yellow",e.getStyle("drop-hint-width")||2),this.bringTop())}}),c=o.createClass("OrderHinter",{base:o.Group,constructor:function(){this.callBase2(o.Group,"constructor",[]),this.area=new o.Rect,this.path=new o.Path,this.addShapes([this.area,this.path])},render:function(e){this.setVisible(!!e),e&&(this.area.setBox(e.area),this.area.fill(e.node.getStyle("order-hint-area-color")||"rgba(0, 255, 0, .5)"),this.path.setPathData(e.path),this.path.stroke(e.node.getStyle("order-hint-path-color")||"#0f0",e.node.getStyle("order-hint-path-width")||1))}}),h=o.createClass("TreeDragger",{constructor:function(e){this._minder=e,this._dropHinter=new u,this._orderHinter=new c,e.getRenderContainer().addShapes([this._dropHinter,this._orderHinter])},dragStart:function(e){this._minder._defaultOptions.readOnly||(this._startPosition=e)},dragMove:function(e){if(this._startPosition){var t=o.Vector.fromPoints(this._dragPosition||this._startPosition,e),n=this._minder;if(this._dragPosition=e,!this._dragMode){if(o.Vector.fromPoints(this._dragPosition,this._startPosition).length()<10)return;if(!this._enterDragMode())return}for(var r=0;r<this._dragSources.length;r++)this._dragSources[r].setLayoutOffset(this._dragSources[r].getLayoutOffset().offset(t)),n.applyLayoutResult(this._dragSources[r]);this._dropTest()?this._renderOrderHint(this._orderSucceedHint=null):this._orderTest()}},dragEnd:function(){var e,t,n,r;this._startPosition=null,this._dragPosition=null,this._dragMode&&(this._fadeDragSources(1),this._dropSucceedTarget?(this._dragSources.forEach(function(e){e.setLayoutOffset(null)}),this._minder.layout(-1),this._minder.execCommand("movetoparent",this._dragSources,this._dropSucceedTarget)):this._orderSucceedHint?(t=(e=this._orderSucceedHint).node.getIndex(),n=this._dragSources.map(function(e){return e.setLayoutOffset(null),e.getIndex()}),r=Math.max.apply(Math,n),t<Math.min.apply(Math,n)&&"down"==e.type&&t++,r<t&&"up"==e.type&&t--,e.node.setLayoutOffset(null),this._minder.execCommand("arrange",t),this._renderOrderHint(null)):this._minder.fire("savescene"),this._minder.layout(300),this._leaveDragMode(),this._minder.fire("contentchange"))},_enterDragMode:function(){return!this._minder._defaultOptions.readOnly&&(this._calcDragSources(),this._dragSources.length?(this._fadeDragSources(.5),this._calcDropTargets(),this._calcOrderHints(),this._dragMode=!0,this._minder.setStatus("dragtree"),!0):(this._startPosition=null,!1))},_calcDragSources:function(){this._dragSources=this._minder.getSelectedAncestors()},_fadeDragSources:function(t){var n=this._minder;this._dragSources.forEach(function(e){e.getRenderContainer().setOpacity(t,200),e.traverse(function(e){t<1?n.detachNode(e):n.attachNode(e)},!0)})},_calcDropTargets:function(){this._dropTargets=function t(n,e){var r,o=[];return o.push(e),e.getChildren().forEach(function(e){for(r=0;r<n.length;r++)if(n[r]==e)return;o=o.concat(t(n,e))}),o}(this._dragSources,this._minder.getRoot()),this._dropTargetBoxes=this._dropTargets.map(function(e){return e.getLayoutBox()})},_calcOrderHints:function(){var n=this._dragSources,e=r.getCommonAncestor(n);e==n[0]&&(e=n[0].parent),0===n.length||e!=n[0].parent?this._orderHints=[]:(e=e.children,this._orderHints=e.reduce(function(e,t){return e=-1==n.indexOf(t)?e.concat(t.getOrderHint()):e},[]))},_leaveDragMode:function(){this._dragMode=!1,this._dropSucceedTarget=null,this._orderSucceedHint=null,this._renderDropHint(null),this._renderOrderHint(null),this._minder.rollbackStatus()},_drawForDragMode:function(){this._text.setContent(this._dragSources.length+" items"),this._text.setPosition(this._startPosition.x,this._startPosition.y+5),this._minder.getRenderContainer().addShape(this)},_boxTest:function(e,t,n){var r,o,i,a,s,u=this._dragSources.map(function(e){return e.getLayoutBox()});for(n=n||function(e,t,n){return e&&!e.isEmpty()},r=0;r<e.length;r++)for(i=e[r],a=t.call(this,i,r),o=0;o<u.length;o++)if(n((s=u[o]).intersect(a),s,a))return i;return null},_dropTest:function(){return this._dropSucceedTarget=this._boxTest(this._dropTargets,function(e,t){return this._dropTargetBoxes[t]},function(e,t,n){function r(e){return e.width*e.height}return!!e&&!!r(e)&&(r(e)>.5*Math.min(r(t),r(n))||e.width+1>=Math.min(t.width,n.width)||e.height+1>=Math.min(t.height,n.height))}),this._renderDropHint(this._dropSucceedTarget),!!this._dropSucceedTarget},_orderTest:function(){return this._orderSucceedHint=this._boxTest(this._orderHints,function(e){return e.area}),this._renderOrderHint(this._orderSucceedHint),!!this._orderSucceedHint},_renderDropHint:function(e){this._dropHinter.render(e)},_renderOrderHint:function(e){this._orderHinter.render(e)},preventDragMove:function(){this._startPosition=null}});a.register("DragTree",function(){var t;return{init:function(){t=new h(this),window.addEventListener("mouseup",function(){t.dragEnd()})},events:{"normal.mousedown inputready.mousedown":function(e){e.originEvent.button||e.getTargetNode()&&e.getTargetNode()!=this.getRoot()&&t.dragStart(e.getPosition())},"normal.mousemove dragtree.mousemove":function(e){t.dragMove(e.getPosition())},"normal.mouseup dragtree.beforemouseup":function(e){t.dragEnd(),e.preventDefault()},statuschange:function(e){"textedit"==e.lastStatus&&"normal"==e.currentStatus&&t.preventDragMove()}},commands:{movetoparent:s}}})}},m[46]={value:function(e,t,n){var s=m.r(17),u=m.r(33),c=m.r(15),h=m.r(21),l=m.r(9),r=m.r(20),d=m.r(27);r.register("Expand",function(){var n=this,o="expandState",r="collapse",e=(s.extendClass(h,{expand:function(){return this.setData(o,"expand"),this},collapse:function(){return this.setData(o,r),this},isExpanded:function(){return this.getData(o)!==r&&(this.isRoot()||this.parent.isExpanded())},isCollapsed:function(){return!this.isExpanded()}}),s.createClass("ExpandCommand",{base:l,execute:function(e,t){var n=e.getSelectedNode();if(n){for(t&&(n=n.parent);n.parent;)n.expand(),n=n.parent;n.renderTree(),e.layout(100)}},queryState:function(e){e=e.getSelectedNode();return!e||e.isRoot()||e.isExpanded()?-1:0}})),t=s.createClass("ExpandToLevelCommand",{base:l,execute:function(e,t){e.getRoot().traverse(function(e){e.getLevel()<t&&e.expand(),e.getLevel()!=t||e.isLeaf()||e.collapse()}),e.refresh(100)},enableReadOnly:!0}),i=s.createClass("CollapseCommand",{base:l,execute:function(e){var t=e.getSelectedNode();t&&(t.collapse(),t.renderTree(),e.layout())},queryState:function(e){e=e.getSelectedNode();return e&&!e.isRoot()&&e.isExpanded()?0:-1}}),a=s.createClass("Expander",{base:s.Group,constructor:function(e){this.callBase2(s.Group,"constructor",[]),this.radius=6,this.outline=new s.Circle(this.radius).stroke("gray").fill("white"),this.sign=(new s.Path).stroke("gray"),this.addShapes([this.outline,this.sign]),this.initEvent(e),this.setId(u.uuid("node_expander")),this.setStyle("cursor","pointer")},initEvent:function(t){var e=this.node;e.addEventListener("mousedown",function(e){n.select([t],!0),t.isExpanded()?t.collapse():t.expand(),t.renderTree().getMinder().layout(100),t.getMinder().fire("contentchange"),e.stopPropagation(),e.preventDefault()}),e.addEventListener("dblclick click mouseup",function(e){e.stopPropagation(),e.preventDefault()})},setState:function(e){var t;"hide"==e?this.setVisible(!1):(this.setVisible(!0),t=["M",1.5-this.radius,0,"L",this.radius-1.5,0],e==r&&t.push(["M",0,1.5-this.radius,"L",0,this.radius-1.5]),this.sign.setPathData(t))}});return{commands:{expand:e,expandtolevel:t,collapse:i},events:{layoutapply:function(e){var t=e.node.getRenderer("ExpanderRenderer");t.getRenderShape()&&t.update(t.getRenderShape(),e.node)},beforerender:function(e){var t=e.node,n=!t.parent||t.parent.isExpanded();t.getRenderContainer().setVisible(n),n||e.stopPropagation()},"normal.keydown":function(e){if("textedit"!=this.getStatus()){if(e.originEvent.keyCode==c["/"]){var t=this.getSelectedNode();if(!t||t==this.getRoot())return;var n=t.isExpanded();this.getSelectedNodes().forEach(function(e){n?e.collapse():e.expand(),e.renderTree()}),this.layout(100),this.fire("contentchange"),e.preventDefault(),e.stopPropagationImmediately()}e.isShortcutKey("Alt+`")&&this.execCommand("expandtolevel",9999);for(var r=1;r<6;r++)e.isShortcutKey("Alt+"+r)&&this.execCommand("expandtolevel",r)}}},renderers:{outside:s.createClass("ExpanderRenderer",{base:d,create:function(e){if(!e.isRoot())return this.expander=new a(e),e.getRenderContainer().prependShape(this.expander),(e.expanderRenderer=this).node=e,this.expander},shouldRender:function(e){return!e.isRoot()},update:function(e,t,n){var r;t.parent&&(r=t.parent.isExpanded(),e.setState(r&&t.children.length?t.getData(o):"hide"),r=t.getLayoutVectorIn().normalize(e.radius+t.getStyle("stroke-width")),e=t.getVertexIn().offset(r.reverse()),this.expander.setTranslate(e))}})},contextmenu:[{command:"expandtoleaf",query:function(){return!n.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",9999)}},{command:"expandtolevel1",query:function(){return!n.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",1)}},{command:"expandtolevel2",query:function(){return!n.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",2)}},{command:"expandtolevel3",query:function(){return!n.getSelectedNode()},fn:function(e){e.execCommand("expandtolevel",3)}},{divider:!0}]}})}},m[47]={value:function(e,t,n){var r=m.r(17),o=(m.r(33),m.r(19),m.r(21),m.r(9)),i=m.r(20);function s(e,t){return e.getData(t)||e.getStyle(t)}m.r(61).registerStyleHook(function(e,t){var n=e.getData("color"),r=e.getStyle("selected-color"),o=e.getStyle("color"),n=n||(e.isSelected()&&r?r:o),i=s(e,"font-family"),a=s(e,"font-size");t.fill(n),t.eachItem(function(e,t){t.setFont({family:i,size:a})})}),i.register("fontmodule",{commands:{forecolor:r.createClass("fontcolorCommand",{base:o,execute:function(e,t){e.getSelectedNodes().forEach(function(e){e.setData("color",t),e.render()})},queryState:function(e){return 0===e.getSelectedNodes().length?-1:0},queryValue:function(e){return 1==e.getSelectedNodes().length?e.getSelectedNodes()[0].getData("color"):"mixed"}}),background:r.createClass("backgroudCommand",{base:o,execute:function(e,t){e.getSelectedNodes().forEach(function(e){e.setData("background",t),e.render()})},queryState:function(e){return 0===e.getSelectedNodes().length?-1:0},queryValue:function(e){return 1==e.getSelectedNodes().length?e.getSelectedNodes()[0].getData("background"):"mixed"}}),fontfamily:r.createClass("fontfamilyCommand",{base:o,execute:function(t,n){t.getSelectedNodes().forEach(function(e){e.setData("font-family",n),e.render(),t.layout()})},queryState:function(e){return 0===e.getSelectedNodes().length?-1:0},queryValue:function(e){e=e.getSelectedNode();return e?e.getData("font-family"):null}}),fontsize:r.createClass("fontsizeCommand",{base:o,execute:function(t,n){t.getSelectedNodes().forEach(function(e){e.setData("font-size",n),e.render(),t.layout(300)})},queryState:function(e){return 0===e.getSelectedNodes().length?-1:0},queryValue:function(e){e=e.getSelectedNode();return e?e.getData("font-size"):null}})}})}},m[48]={value:function(e,t,n){var s=m.r(17),r=(m.r(33),m.r(19),m.r(21),m.r(9)),o=m.r(20),i=m.r(27);o.register("hyperlink",{commands:{hyperlink:s.createClass("hyperlink",{base:r,execute:function(e,t,n){e.getSelectedNodes().forEach(function(e){e.setData("hyperlink",t),e.setData("hyperlinkTitle",t&&n),e.render()}),e.layout()},queryState:function(e){var e=e.getSelectedNodes(),t=0;return 0===e.length?-1:(e.forEach(function(e){if(e&&e.getData("hyperlink"))return t=0,!1}),t)},queryValue:function(e){e=e.getSelectedNode();return{url:e.getData("hyperlink"),title:e.getData("hyperlinkTitle")}}})},renderers:{right:s.createClass("hyperlinkrender",{base:i,create:function(){var e=new s.HyperLink,t=new s.Path,n=new s.Rect(24,22,-2,-6,4).fill("rgba(255, 255, 255, 0)");return t.setPathData("M16.614,10.224h-1.278c-1.668,0-3.07-1.07-3.599-2.556h4.877c0.707,0,1.278-0.571,1.278-1.278V3.834 c0-0.707-0.571-1.278-1.278-1.278h-4.877C12.266,1.071,13.668,0,15.336,0h1.278c2.116,0,3.834,1.716,3.834,3.834V6.39 C20.448,8.508,18.73,10.224,16.614,10.224z M5.112,5.112c0-0.707,0.573-1.278,1.278-1.278h7.668c0.707,0,1.278,0.571,1.278,1.278 S14.765,6.39,14.058,6.39H6.39C5.685,6.39,5.112,5.819,5.112,5.112z M2.556,3.834V6.39c0,0.707,0.573,1.278,1.278,1.278h4.877 c-0.528,1.486-1.932,2.556-3.599,2.556H3.834C1.716,10.224,0,8.508,0,6.39V3.834C0,1.716,1.716,0,3.834,0h1.278 c1.667,0,3.071,1.071,3.599,2.556H3.834C3.129,2.556,2.556,3.127,2.556,3.834z").fill("#666"),e.addShape(n),e.addShape(t),e.setTarget("_blank"),e.setStyle("cursor","pointer"),e.on("mouseover",function(){n.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){n.fill("rgba(255, 255, 255, 0)")}),e},shouldRender:function(e){return e.getData("hyperlink")},update:function(e,t,n){for(var r=t.getData("hyperlink"),o=(e.setHref("#"),["^http:","^https:","^ftp:","^mailto:"]),i=0;i<o.length;i++)if(new RegExp(o[i]).test(r)){e.setHref(r);break}var a=(a=t.getData("hyperlinkTitle"))?[a,"(",r,")"].join(""):r,a=(e.node.setAttributeNS("http://www.w3.org/1999/xlink","title",a),t.getStyle("space-right"));return e.setTranslate(n.right+a+2,-5),new s.Box({x:n.right+a,y:-11,width:24,height:22})}})}})}},m[49]={value:function(e,t,n){var r=m.r(17),s=m.r(15),o=m.r(20);m.r(9);o.register("ImageViewer",function(){function i(e,t,n){var r=document.createElement(e);return o(r,t),n&&n.length&&n.forEach(function(e){r.appendChild(e)}),r}function a(e,t,n){e.addEventListener(t,n)}function o(t,e){e&&e.split(" ").forEach(function(e){t.classList.add(e)})}var e=r.createClass("ImageViewer",{constructor:function(){var e=i("button","km-image-viewer-btn km-image-viewer-close"),t=i("button","km-image-viewer-btn km-image-viewer-source"),n=this.image=i("img"),r=this.toolbar=i("div","km-image-viewer-toolbar",[t,e]),o=i("div","km-image-viewer-container",[n]),r=this.viewer=i("div","km-image-viewer",[r,o]);this.hotkeyHandler=this.hotkeyHandler.bind(this),a(e,"click",this.close.bind(this)),a(t,"click",this.viewSource.bind(this)),a(n,"click",this.zoomImage.bind(this)),a(r,"contextmenu",this.toggleToolbar.bind(this)),a(document,"keydown",this.hotkeyHandler)},dispose:function(){this.close(),document.removeEventListener("remove",this.hotkeyHandler)},hotkeyHandler:function(e){this.actived&&e.keyCode===s.esc&&this.close()},toggleToolbar:function(e){e&&e.preventDefault(),this.toolbar.classList.toggle("hidden")},zoomImage:function(e){var t=this.image;"boolean"==typeof e?e&&o(t,"limited"):t.classList.toggle("limited")},viewSource:function(e){window.open(this.image.src)},open:function(e){var t=document.querySelector("input");t&&(t.focus(),t.blur()),this.image.src=e,this.zoomImage(!0),document.body.appendChild(this.viewer),this.actived=!0},close:function(){this.image.src="",document.body.removeChild(this.viewer),this.actived=!1}});return{init:function(){this.viewer=new e},events:{"normal.dblclick":function(e){e=e.kityEvent.targetShape;"Image"===e.__KityClassName&&e.url&&this.viewer.open(e.url)}}}})}},m[50]={value:function(e,t,n){var a=m.r(17),r=(m.r(33),m.r(19),m.r(21),m.r(9)),o=m.r(20),i=m.r(27);o.register("image",function(){return{defaultOptions:{maxImageWidth:200,maxImageHeight:200},commands:{image:a.createClass("ImageCommand",{base:r,execute:function(u,c,h){var e,t,n,r=u.getSelectedNodes();e=c,t=function(a,s){r.forEach(function(e){t=a,n=s,i=u.getOption("maxImageWidth"),r=u.getOption("maxImageHeight"),o=t/n,i<t&&i/r<o?n=(t=i)/o:r<n&&(t=(n=r)*o);var t,n,r,o,i={width:0|t,height:0|n};e.setData("image",c),e.setData("imageTitle",c&&h),e.setData("imageSize",c&&i),e.render()}),u.fire("saveScene"),u.layout(300)},(n=document.createElement("img")).onload=function(){t(n.width,n.height)},n.onerror=function(){t(null)},n.src=e},queryState:function(e){var e=e.getSelectedNodes(),t=0;return 0===e.length?-1:(e.forEach(function(e){if(e&&e.getData("image"))return t=0,!1}),t)},queryValue:function(e){e=e.getSelectedNode();return{url:e.getData("image"),title:e.getData("imageTitle")}}})},renderers:{top:a.createClass("ImageRenderer",{base:i,create:function(e){return new a.Image(e.getData("image"))},shouldRender:function(e){return e.getData("image")},update:function(e,t,n){var r=t.getData("image"),o=t.getData("imageTitle"),i=t.getData("imageSize"),t=t.getStyle("space-top");if(i)return o&&e.node.setAttributeNS("http://www.w3.org/1999/xlink","title",o),o=n.cx-i.width/2,n=n.y-i.height-t,e.setUrl(r).setX(0|o).setY(0|n).setWidth(0|i.width).setHeight(0|i.height),new a.Box(0|o,0|n,0|i.width,0|i.height)}})}}})}},m[51]={value:function(e,t,n){m.r(17),m.r(33),m.r(15),m.r(19),m.r(21),m.r(9);var r=m.r(20);m.r(27);r.register("KeyboardModule",function(){var l=Math.min,d=Math.max,g=(Math.abs,Math.sqrt);Math.exp;function i(e){var t,n=[];e.traverse(function(e){(t=e.getLayoutBox()).width&&t.height&&n.push({left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height,width:t.width,height:t.height,node:e})});for(var r=0;r<n.length;r++){h=i=o=c=u=s=a=void 0;for(var o,i,a=n,s=r,u=a[s],c={},h=0;h<a.length;h++)h!=s&&(o=a[h],i=function(e,t){var n,r;n=l(e.left,t.left),i=d(e.right,t.right),o=l(e.top,t.top),r=d(e.bottom,t.bottom),i=i-n-e.width-t.width,n=r-o-e.height-t.height,r=i<0?n:n<0?i:g(i*i+n*n);var o=e.node,i=t.node;o.parent==i.parent&&(r/=10);i.parent==o&&(r/=5);return r}(o,u),o.right<u.left&&(!c.left||i<c.left.dist)&&(c.left={dist:i,node:o.node}),o.left>u.right&&(!c.right||i<c.right.dist)&&(c.right={dist:i,node:o.node}),o.bottom<u.top&&(!c.top||i<c.top.dist)&&(c.top={dist:i,node:o.node}),o.top>u.bottom)&&(!c.down||i<c.down.dist)&&(c.down={dist:i,node:o.node});u.node._nearestNodes={right:c.right&&c.right.node||null,top:c.top&&c.top.node||null,left:c.left&&c.left.node||null,down:c.down&&c.down.node||null}}}return{events:{layoutallfinish:function(){i(this.getRoot())},"normal.keydown readonly.keydown":function(r){var o=this;["left","right","up","down"].forEach(function(e){var t,n;r.isShortcutKey(e)&&(e="up"==e?"top":e,(n=(t=o).getSelectedNode())?(n._nearestNodes||i(t.getRoot()),(n=n._nearestNodes[e])&&t.select(n,!0)):(t.select(t.getRoot()),i(t.getRoot())),r.preventDefault())})}}}})}},m[52]={value:function(e,t,n){var r=m.r(17),o=m.r(9),i=m.r(20),a=r.createClass("LayoutCommand",{base:o,execute:function(e,t){e.getSelectedNodes().forEach(function(e){e.layout(t)})},queryValue:function(e){e=e.getSelectedNode();if(e)return e.getData("layout")},queryState:function(e){return e.getSelectedNode()?0:-1}}),r=r.createClass("ResetLayoutCommand",{base:o,execute:function(e){var t=e.getSelectedNodes();(t=t.length?t:[e.getRoot()]).forEach(function(e){e.traverse(function(e){e.resetLayoutOffset(),e.isRoot()||e.setData("layout",null)})}),e.layout(300)},enableReadOnly:!0});i.register("LayoutModule",{commands:{layout:a,resetlayout:r},contextmenu:[{command:"resetlayout"},{divider:!0}],commandShortcutKeys:{resetlayout:"Ctrl+Shift+L"}})}},m[53]={value:function(e,t,n){var r=m.r(17),o=(m.r(33),m.r(19),m.r(21)),i=m.r(9),a=m.r(20),s=(m.r(27),r.createClass("AppendChildCommand",{base:i,execute:function(e,t){var n=e.getSelectedNode();if(!n)return null;t=e.createNode(t,n);e.select(t,!0),n.isExpanded()?t.render():(n.expand(),n.renderTree()),e.layout(600)},queryState:function(e){return e.getSelectedNode()?0:-1}})),u=r.createClass("AppendSiblingCommand",{base:i,execute:function(e,t){var n=e.getSelectedNode(),r=n.parent;if(!r)return e.execCommand("AppendChildNode",t);t=e.createNode(t,r,n.getIndex()+1);t.setGlobalLayoutTransform(n.getGlobalLayoutTransform()),e.select(t,!0),t.render(),e.layout(600)},queryState:function(e){return e.getSelectedNode()?0:-1}}),c=r.createClass("RemoverNodeCommand",{base:i,execute:function(t){var e=t.getSelectedNodes(),n=o.getCommonAncestor.apply(null,e),r=e[0].getIndex();e.forEach(function(e){e.isRoot()||t.removeNode(e)}),1==e.length?(e=n.children[r-1]||n.children[r],t.select(e||n||t.getRoot(),!0)):t.select(n||t.getRoot(),!0),t.layout(600)},queryState:function(e){e=e.getSelectedNode();return e&&!e.isRoot()?0:-1}}),h=r.createClass("AppendParentCommand",{base:i,execute:function(e,t){var n=e.getSelectedNodes(),r=(n.sort(function(e,t){return e.getIndex()-t.getIndex()}),n[0].parent),o=e.createNode(t,r,n[0].getIndex());n.forEach(function(e){o.appendChild(e)}),o.setGlobalLayoutTransform(n[n.length>>1].getGlobalLayoutTransform()),e.select(o,!0),e.layout(600)},queryState:function(e){var t=e.getSelectedNodes();if(!t.length)return-1;var n=t[0].parent;if(!n)return-1;for(var r=1;r<t.length;r++)if(t[r].parent!=n)return-1;return 0}});a.register("NodeModule",function(){return{commands:{AppendChildNode:s,AppendSiblingNode:u,RemoveNode:c,AppendParentNode:h},commandShortcutKeys:{appendsiblingnode:"normal::Enter",appendchildnode:"normal::Insert|Tab",appendparentnode:"normal::Shift+Tab|normal::Shift+Insert",removenode:"normal::Del|Backspace"}}})}},m[54]={value:function(e,t,n){var o=m.r(17),r=(m.r(33),m.r(19),m.r(21),m.r(9)),i=m.r(20),a=m.r(27);i.register("NoteModule",function(){var e=o.createClass("NoteCommand",{base:r,execute:function(e,t){e=e.getSelectedNode();e.setData("note",t),e.render(),e.getMinder().layout(300)},queryState:function(e){return 1===e.getSelectedNodes().length?0:-1},queryValue:function(e){e=e.getSelectedNode();return e&&e.getData("note")}}),n=o.createClass("NoteIcon",{base:o.Group,constructor:function(){this.callBase2(o.Group,"constructor",[]),this.width=16,this.height=17,this.rect=new o.Rect(16,17,.5,-8.5,2).fill("transparent"),this.path=(new o.Path).setPathData("M9,9H3V8h6L9,9L9,9z M9,7H3V6h6V7z M9,5H3V4h6V5z M8.5,11H2V2h8v7.5 M9,12l2-2V1H1v11").setTranslate(2.5,-6.5),this.addShapes([this.rect,this.path]),this.on("mouseover",function(){this.rect.fill("rgba(255, 255, 200, .8)")}).on("mouseout",function(){this.rect.fill("transparent")}),this.setStyle("cursor","pointer")}});return{renderers:{right:o.createClass("NoteIconRenderer",{base:a,create:function(t){var e=new n;return e.on("mousedown",function(e){e.preventDefault(),t.getMinder().fire("editnoterequest")}),e.on("mouseover",function(){t.getMinder().fire("shownoterequest",{node:t,icon:e})}),e.on("mouseout",function(){t.getMinder().fire("hidenoterequest",{node:t,icon:e})}),e},shouldRender:function(e){return e.getData("note")},update:function(e,t,n){var r=n.right+t.getStyle("space-left"),n=n.cy;return e.path.fill(t.getStyle("color")),e.setTranslate(r,n),new o.Box(r,Math.round(n-e.height/2),e.width,e.height)}})},commands:{note:e}}})}},m[55]={value:function(e,t,n){var u=m.r(17),r=m.r(33),o=(m.r(19),m.r(21),m.r(9),m.r(20)),i=m.r(27),a=u.createClass("OutlineRenderer",{base:i,create:function(e){var t=(new u.Rect).setId(r.uuid("node_outline"));return this.bringToBack=!0,t},update:function(e,t,n){var r=t.getStyle("shape"),o=t.getStyle("padding-left"),i=t.getStyle("padding-right"),a=t.getStyle("padding-top"),s=t.getStyle("padding-bottom"),o={x:n.x-o,y:n.y-a,width:n.width+o+i,height:n.height+a+s},i=t.getStyle("radius"),s=(r&&"circle"==r&&(a=Math.pow,i=(0,Math.round)(Math.sqrt(a(o.width,2)+a(o.height,2))/2),o.x=n.cx-i,o.y=n.cy-i,o.width=2*i,o.height=2*i),t.isSelected()?t.getMinder().isFocused()?"selected-":"blur-selected-":"");return e.setPosition(o.x,o.y).setSize(o.width,o.height).setRadius(i).fill(t.getData("background")||t.getStyle(s+"background")||t.getStyle("background")).stroke(t.getStyle(s+"stroke"||t.getStyle("stroke")),t.getStyle(s+"stroke-width")),new u.Box(o)}}),s=u.createClass("ShadowRenderer",{base:i,create:function(e){return this.bringToBack=!0,new u.Rect},shouldRender:function(e){return e.getStyle("shadow")},update:function(e,t,n){e.setPosition(n.x+4,n.y+5).fill(t.getStyle("shadow"));var r=t.getStyle("shape");r?"circle"==r&&(r=Math.max(n.width,n.height),e.setSize(r,r),e.setRadius(r/2)):(e.setSize(n.width,n.height),e.setRadius(t.getStyle("radius")))}}),c=new u.Marker,h=(c.setWidth(10),c.setHeight(12),c.setRef(0,0),c.setViewBox(-6,-4,8,10),c.addShape((new u.Path).setPathData("M-5-3l5,3,-5,3").stroke("#33ffff")),/wire/.test(window.location.href)),l=u.createClass("WireframeRenderer",{base:i,create:function(){var e=new u.Group,t=this.oxy=(new u.Path).stroke("#f6f").setPathData("M0,-50L0,50M-50,0L50,0"),n=this.wireframe=(new u.Rect).stroke("lightgreen"),r=this.vectorIn=(new u.Path).stroke("#66ffff"),o=this.vectorOut=(new u.Path).stroke("#66ffff");return r.setMarker(c,"end"),o.setMarker(c,"end"),e.addShapes([t,n,r,o])},shouldRender:function(){return h},update:function(e,t,n){this.wireframe.setPosition(n.x,n.y).setSize(n.width,n.height);var n=t.getVertexIn(),r=t.getVertexOut(),o=t.getLayoutVectorIn().normalize(30),t=t.getLayoutVectorOut().normalize(30);this.vectorIn.setPathData(["M",n.offset(o.reverse()),"L",n]),this.vectorOut.setPathData(["M",r,"l",t])}});o.register("OutlineModule",function(){return{events:h?{ready:function(){this.getPaper().addResource(c)},layoutallfinish:function(){this.getRoot().traverse(function(e){e.getRenderer("WireframeRenderer").update(null,e,e.getContentBox())})}}:null,renderers:{outline:a,outside:[s,l]}}})}},m[56]={value:function(e,t,n){var a=m.r(17),s=m.r(33),u=(m.r(19),m.r(21),m.r(9)),r=m.r(20),c=m.r(27);r.register("PriorityModule",function(){var i=[null,["#FF1200","#840023"],["#0074FF","#01467F"],["#00AF00","#006300"],["#FF962E","#B25000"],["#A464FF","#4720C4"],["#A3A3A3","#515151"],["#A3A3A3","#515151"],["#A3A3A3","#515151"],["#A3A3A3","#515151"]],r="M20,10c0,3.866-3.134,7-7,7H7c-3.866,0-7-3.134-7-7V7c0-3.866,3.134-7,7-7h6c3.866,0,7,3.134,7,7V10z",o="priority",t=a.createClass("PriorityIcon",{base:a.Group,constructor:function(){this.callBase2(a.Group,"constructor",[]),this.setSize(20),this.create(),this.setId(s.uuid("node_priority"))},setSize:function(e){this.width=this.height=e},create:function(){(new a.Path).setPathData(r).fill("white");var e=(new a.Path).setPathData("M0,13c0,3.866,3.134,7,7,7h6c3.866,0,7-3.134,7-7V7H0V13z").setTranslate(.5,.5),t=(new a.Path).setPathData(r).setOpacity(.8).setTranslate(.5,.5),n=(new a.Text).setX(this.width/2-.5).setY(this.height/2).setTextAnchor("middle").setVerticalAlign("middle").setFontItalic(!0).setFontSize(12).fill("white");this.addShapes([e,t,n]),this.mask=t,this.back=e,this.number=n},setValue:function(e){var t=this.back,n=this.mask,r=this.number,o=i[e];o&&(t.fill(o[1]),n.fill(o[0])),r.setContent(e)}});return{commands:{priority:a.createClass("SetPriorityCommand",{base:u,execute:function(e,t){for(var n=e.getSelectedNodes(),r=0;r<n.length;r++)n[r].setData(o,t||null).render();e.layout()},queryValue:function(e){for(var t,n=e.getSelectedNodes(),r=0;r<n.length&&!(t=n[r].getData(o));r++);return t||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}})},renderers:{left:a.createClass("PriorityRenderer",{base:c,create:function(e){return new t},shouldRender:function(e){return e.getData(o)},update:function(e,t,n){var r=t.getData(o),t=t.getStyle("space-left");return e.setValue(r),r=n.left-e.width-t,n=-e.height/2,e.setTranslate(r,n),new a.Box({x:r,y:n,width:e.width,height:e.height})}})}}})}},m[57]={value:function(e,t,n){var a=m.r(17),r=m.r(33),s=(m.r(19),m.r(21),m.r(9)),o=m.r(20),u=m.r(27);o.register("ProgressModule",function(){var o="progress",i=(new a.LinearGradient).pipe(function(e){e.setStartPosition(0,0),e.setEndPosition(0,1),e.addStop(0,"#fff"),e.addStop(1,"#ccc")}),t=(this.getPaper().addResource(i),a.createClass("ProgressIcon",{base:a.Group,constructor:function(e){this.callBase2(a.Group,"constructor",[]),this.setSize(20),this.create(),this.setValue(e),this.setId(r.uuid("node_progress")),this.translate(.5,.5)},setSize:function(e){this.width=this.height=e},create:function(){var e=new a.Circle(9).fill("#FFED83"),t=new a.Pie(9,0).fill("#43BC00"),n=(new a.Path).setPathData("M10,3c4.418,0,8,3.582,8,8h1c0-5.523-3.477-10-9-10S1,5.477,1,11h1C2,6.582,5.582,3,10,3z").setTranslate(-10,-10).fill("#8E8E8E"),r=(new a.Path).setTranslate(-10,-10).setPathData("M10,0C4.477,0,0,4.477,0,10c0,5.523,4.477,10,10,10s10-4.477,10-10C20,4.477,15.523,0,10,0zM10,18c-4.418,0-8-3.582-8-8s3.582-8,8-8s8,3.582,8,8S14.418,18,10,18z").fill(i),o=(new a.Path).setTranslate(-10,-10).setPathData("M15.812,7.896l-6.75,6.75l-4.5-4.5L6.25,8.459l2.812,2.803l5.062-5.053L15.812,7.896z").fill("#EEE");this.addShapes([e,t,n,o,r]),this.pie=t,this.check=o},setValue:function(e){this.pie.setAngle(-360*(e-1)/8),this.check.setVisible(9==e)}}));return{commands:{progress:a.createClass("ProgressCommand",{base:s,execute:function(e,t){for(var n=e.getSelectedNodes(),r=0;r<n.length;r++)n[r].setData(o,t||null).render();e.layout()},queryValue:function(e){for(var t,n=e.getSelectedNodes(),r=0;r<n.length&&!(t=n[r].getData(o));r++);return t||null},queryState:function(e){return e.getSelectedNodes().length?0:-1}})},renderers:{left:a.createClass("ProgressRenderer",{base:u,create:function(e){return new t},shouldRender:function(e){return e.getData(o)},update:function(e,t,n){var r=t.getData(o),t=t.getStyle("space-left");return e.setValue(r),r=n.left-e.width-t,n=-e.height/2,e.setTranslate(r+e.width/2,n+e.height/2),new a.Box(r,n,e.width,e.height)}})}}})}},m[58]={value:function(e,t,n){var b=m.r(17),i=(m.r(33),m.r(19)),u=(m.r(21),m.r(9)),r=m.r(20),c=m.r(27);r.register("Resource",function(){f=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],m=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479],p=function(e){return e<0&&(e+=4*(1<<30)),("00000000"+e.toString(16)).slice(-8)},a=[[16,50,84,118,152,186,220,254],[174,132,249,109,193,32,123,53],[139,12,37,223,234,99,23,73],[151,19,205,235,98,165,4,143],[9,117,66,250,30,203,134,211],[194,166,176,56,212,87,239,145],[92,241,222,164,112,54,41,184],[189,231,28,147,5,79,104,162],[246,158,59,128,44,125,65,90],[42,72,103,81,191,233,195,13]],s=function(e,t,n){t=d[e]^d[t];d[e]=t>>>n|t<<32-n},y=function(e,t,n,r,o){var i=l+a[h][e]%16,e=l+(a[h][e]>>4);r=8+r%4,o=12+o%4,d[t%=4]+=d[n=4+n%4]+(g[i]^m[e%16]),s(o,t,16),d[r]+=d[o],s(n,r,12),d[t]+=d[n]+(g[e]^m[i%16]),s(o,t,8),d[r]+=d[o],s(n,r,7)};var h,l,d,g,f,m,p,a,s,y,r=function(e,t){var n,r,o,i,a,s,u,c;for(t instanceof Array&&4===t.length||(t=[0,0,0,0]),r=f.slice(0),n=m.slice(0,8),h=0;h<4;h+=1)n[h]^=t[h];if(a=446<(o=16*e.length)%512||o%512==0?0:o,o%512==432)e+="老";else{for(e+="耀";e.length%32!=27;)e+="\0";e+=""}for(g=[],c=0;c<e.length;c+=2)g.push(65536*e.charCodeAt(c)+e.charCodeAt(c+1));for(g.push(0),g.push(o),s=g.length-16,l=u=0;l<g.length;l+=16){for(u+=512,i=l===s?a:Math.min(o,u),(d=r.concat(n))[12]^=i,d[13]^=i,h=0;h<10;h+=1)for(c=0;c<8;c+=1)c<4?y(c,c,c,c,c):y(c,c,c+1,c+2,c+3);for(c=0;c<8;c+=1)r[c]^=t[c%4]^d[c]^d[c+8]}return r.map(p).join("")},o=[51,303,75,200,157,0,26,254].map(function(e){return b.Color.createHSL(e,100,85)}),e=(b.extendClass(i,{getHashCode:function(e){for(var t=1315423911,n=(e=r(e)).length-1;0<=n;n--)t^=(t<<5)+e.charCodeAt(n)+(t>>2);return 2147483647&t},getResourceColor:function(e){var t,n=this._getResourceColorIndexMapping();return Object.prototype.hasOwnProperty.call(n,e)||(t=this._getNextResourceColorIndex(),n[e]=t),o[n[e]]||b.Color.createHSL(Math.floor(this.getHashCode(e)/2147483647*359),100,85)},getUsedResource:function(){var e,t=this._getResourceColorIndexMapping(),n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n},_getNextResourceColorIndex:function(){var e,t,n=this._getResourceColorIndexMapping(),r=[];for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&r.push(n[e]);for(t=0;t<o.length;t++)if(!~r.indexOf(t))return t;return-1},_getResourceColorIndexMapping:function(){return this._resourceColorMapping||(this._resourceColorMapping={})}}),b.createClass("ResourceCommand",{base:u,execute:function(e,t){var n=e.getSelectedNodes();"string"==typeof t&&(t=[t]),n.forEach(function(e){e.setData("resource",t).render()}),e.layout(200)},queryValue:function(e){var e=e.getSelectedNodes(),t=[];return e.forEach(function(e){e=e.getData("resource");e&&e.forEach(function(e){~t.indexOf(e)||t.push(e)})}),t},queryState:function(e){return e.getSelectedNode()?0:-1}})),v=b.createClass("ResourceOverlay",{base:b.Group,constructor:function(){var e,t;this.callBase2(b.Group,"constructor",[]),t=this.rect=(new b.Rect).setRadius(4),e=this.text=(new b.Text).setFontSize(12).setVerticalAlign("middle"),this.addShapes([t,e])},setValue:function(e,t){var n,r=this.text;e==this.lastResourceName?n=this.lastBox:(r.setContent(e),n=r.getBoundaryBox(),this.lastResourceName=e,this.lastBox=n),r.setX(8).fill(t.dec("l",70)),(e=this.rect).setPosition(0,n.y-4),this.width=Math.round(n.width+16),this.height=Math.round(n.height+8),e.setSize(this.width,this.height),e.fill(t)}});return{commands:{resource:e},renderers:{right:b.createClass("ResourceRenderer",{base:c,create:function(e){return this.overlays=[],new b.Group},shouldRender:function(e){return e.getData("resource")&&e.getData("resource").length},update:function(e,t,n){var r=t.getStyle("space-right"),o=this.overlays,i=t.getData("resource").filter(function(e){return null!==e});if(0!==i.length){for(var a,s=t.getMinder(),u=0,c=0;c<i.length;c++)u+=r,(a=o[c])||(a=new v,o.push(a),e.addShape(a)),a.setVisible(!0),a.setValue(i[c],s.getResourceColor(i[c])),a.setTranslate(u,-1),u+=a.width;for(;a=o[c++];)a.setVisible(!1);return e.setTranslate(n.right,0),new b.Box({x:n.right,y:Math.round(-o[0].height/2),width:u,height:o[0].height})}}})}}})}},m[59]={value:function(e,t,n){var h=m.r(17),r=(m.r(33),m.r(19),m.r(21),m.r(9),m.r(20));m.r(27);r.register("Select",function(){var o,i,a,s=this,u=s.getRenderContainer(),n=(o=null,i=new h.Path,a=!1,{selectStart:function(e){if(!e.originEvent.button&&!e.originEvent.altKey)return o?this.selectEnd():void(o=e.getPosition(u).round())},selectMove:function(e){if("textedit"!=s.getStatus()&&o){var t=o,e=e.getPosition(u);if(!a){if(h.Vector.fromPoints(t,e).length()<10)return;a=!0,u.addShape(i),i.fill(s.getStyle("marquee-background")).stroke(s.getStyle("marquee-stroke")).setOpacity(.8).getDrawer().clear()}var n=new h.Box(t.x,t.y,e.x-t.x,e.y-t.y),r=[];n.left=Math.round(n.left),n.top=Math.round(n.top),n.right=Math.round(n.right),n.bottom=Math.round(n.bottom),i.getDrawer().pipe(function(){this.clear(),this.moveTo(n.left,n.top),this.lineTo(n.right,n.top),this.lineTo(n.right,n.bottom),this.lineTo(n.left,n.bottom),this.close()}),s.getRoot().traverse(function(e){e.getLayoutBox().intersect(n).isEmpty()||r.push(e)}),s.select(r,!0),window.getSelection().removeAllRanges()}},selectEnd:function(e){o=o&&null,a&&(i.fadeOut(200,"ease",0,function(){i.remove&&i.remove()}),a=!1)}}),r=null,c=null;return{init:function(){window.addEventListener("mouseup",function(){n.selectEnd()})},events:{mousedown:function(e){var t=e.getTargetNode();t?e.isShortcutKey("Ctrl")?this.toggleSelect(t):t.isSelected()?this.isSingleSelect()||(r=t,c=e.getPosition()):this.select(t,!0):(this.removeAllSelectedNodes(),n.selectStart(e),this.setStatus("normal"))},mousemove:n.selectMove,mouseup:function(e){var t=e.getTargetNode();t&&t==r&&(t=e.getPosition(),h.Vector.fromPoints(c,t).length()<1&&this.select(r,!0),r=null),n.selectEnd(e)},"normal.keydown":function(e){var t;e.isShortcutKey("ctrl+a")&&(t=[],this.getRoot().traverse(function(e){t.push(e)}),this.select(t,!0),e.preventDefault())}}}})}},m[60]={value:function(e,t,n){var i=m.r(17),a=(m.r(33),m.r(19),m.r(21),m.r(9)),r=m.r(20);m.r(27);r.register("StyleModule",function(){var r=["font-size","font-family","font-weight","font-style","background","color"],n=null;function o(e){for(var t=e.getData(),n=0;n<r.length;n++)if(r[n]in t)return 1}return{commands:{copystyle:i.createClass("CopyStyleCommand",{base:a,execute:function(e){var t=e.getSelectedNode().getData();return n={},r.forEach(function(e){e in t?n[e]=t[e]:(n[e]=null,delete n[e])}),n},queryState:function(e){e=e.getSelectedNodes();return 1===e.length&&o(e[0])?0:-1}}),pastestyle:i.createClass("PastStyleCommand",{base:a,execute:function(e){return e.getSelectedNodes().forEach(function(e){for(var t in n)n.hasOwnProperty(t)&&e.setData(t,n[t])}),e.renderNodeBatch(e.getSelectedNodes()),e.layout(300),n},queryState:function(e){return n&&e.getSelectedNodes().length?0:-1}}),clearstyle:i.createClass("ClearStyleCommand",{base:a,execute:function(e){return e.getSelectedNodes().forEach(function(t){r.forEach(function(e){t.setData(e)})}),e.renderNodeBatch(e.getSelectedNodes()),e.layout(300),n},queryState:function(e){var t=e.getSelectedNodes();if(t.length)for(var n=0;n<t.length;n++)if(o(t[n]))return 0;return-1}})}}})}},m[61]={value:function(e,t,n){var p=m.r(17),r=m.r(33),o=(m.r(19),m.r(21)),i=m.r(9),a=m.r(20),s=m.r(27),y={safari:{"微软雅黑,Microsoft YaHei":-.17,"楷体,楷体_GB2312,SimKai":-.1,"隶书, SimLi":-.1,"comic sans ms":-.23,"impact,chicago":-.15,"times new roman":-.1,"arial black,avant garde":-.17,default:0},ie:{10:{"微软雅黑,Microsoft YaHei":-.17,"comic sans ms":-.17,"impact,chicago":-.08,"times new roman":.04,"arial black,avant garde":-.17,default:-.15},11:{"微软雅黑,Microsoft YaHei":-.17,"arial,helvetica,sans-serif":-.17,"comic sans ms":-.17,"impact,chicago":-.08,"times new roman":.04,"sans-serif":-.16,"arial black,avant garde":-.17,default:-.15}},edge:{"微软雅黑,Microsoft YaHei":-.15,"arial,helvetica,sans-serif":-.17,"comic sans ms":-.17,"impact,chicago":-.08,"sans-serif":-.16,"arial black,avant garde":-.17,default:-.15},sg:{"微软雅黑,Microsoft YaHei":-.15,"arial,helvetica,sans-serif":-.05,"comic sans ms":-.22,"impact,chicago":-.16,"times new roman":-.03,"arial black,avant garde":-.22,default:-.15},chrome:{Mac:{"andale mono":-.05,"comic sans ms":-.3,"impact,chicago":-.13,"times new roman":-.1,"arial black,avant garde":-.17,default:0},Win:{"微软雅黑,Microsoft YaHei":-.15,"arial,helvetica,sans-serif":-.02,"arial black,avant garde":-.2,"comic sans ms":-.2,"impact,chicago":-.12,"times new roman":-.02,default:-.15},Lux:{"andale mono":-.05,"comic sans ms":-.3,"impact,chicago":-.13,"times new roman":-.1,"arial black,avant garde":-.17,default:0}},firefox:{Mac:{"微软雅黑,Microsoft YaHei":-.2,"宋体,SimSun":.05,"comic sans ms":-.2,"impact,chicago":-.15,"arial black,avant garde":-.17,"times new roman":-.1,default:.05},Win:{"微软雅黑,Microsoft YaHei":-.16,"andale mono":-.17,"arial,helvetica,sans-serif":-.17,"comic sans ms":-.22,"impact,chicago":-.23,"times new roman":-.22,"sans-serif":-.22,"arial black,avant garde":-.17,default:-.16},Lux:{"宋体,SimSun":-.2,"微软雅黑,Microsoft YaHei":-.2,"黑体, SimHei":-.2,"隶书, SimLi":-.2,"楷体,楷体_GB2312,SimKai":-.2,"andale mono":-.2,"arial,helvetica,sans-serif":-.2,"comic sans ms":-.2,"impact,chicago":-.2,"times new roman":-.2,"sans-serif":-.2,"arial black,avant garde":-.2,default:-.16}}},u=p.createClass("TextRenderer",{base:s,create:function(){return(new p.Group).setId(r.uuid("node_text"))},update:function(t,n){function e(e){return n.getData(e)||n.getStyle(e)}var r,o,i,a=n.getText(),s=a?a.split("\n"):[" "],u=n.getStyle("line-height"),c=e("font-size"),a=e("font-family")||"default",h=-(u*c*s.length-(u-1)*c)/2,l=p.Browser,d=(l.chrome||l.opera||l.bd||"chrome"===l.lb?m=y.chrome[l.platform][a]:l.gecko?m=y.firefox[l.platform][a]:l.sg?m=y.sg[a]:l.safari?m=y.safari[a]:l.ie?m=y.ie[l.version][a]:l.edge?m=y.edge[a]:l.lb&&(m=.9),t.setTranslate(0,(m||0)*c),new p.Box),g=Math.round,a=(this.setTextStyle(n,t),s.length),l=t.getItems().length;if(a<l)for(r=a;t.getItem(r);)t.removeItem(r);else if(l<a)for(var f=a-l;f--;)o=(new p.Text).setAttr("text-rendering","inherit"),p.Browser.ie||p.Browser.edge?o.setVerticalAlign("top"):o.setAttr("dominant-baseline","text-before-edge"),t.addItem(o);for(r=0;i=s[r],o=t.getItem(r);r++)o.setContent(i),(p.Browser.ie||p.Browser.edge)&&o.fixPosition();this.setTextStyle(n,t);var m=n.getText()+["font-size","font-name","font-weight","font-style"].map(e).join("/");return n._currentTextHash==m&&n._currentTextGroupBox?n._currentTextGroupBox:(n._currentTextHash=m,function(){t.eachItem(function(e,t){e=h+e*c*u,t.setY(e),t=t.getBoundaryBox();d=d.merge(new p.Box(0,e,t.height&&t.width||1,c))});var e=new p.Box(g(d.x),g(d.y),g(d.width),g(d.height));return n._currentTextGroupBox=e})},setTextStyle:function(t,n){u._styleHooks.forEach(function(e){e(t,n)})}}),s=p.createClass({base:i,execute:function(e,t){var n=e.getSelectedNode();n&&(n.setText(t),n.render(),e.layout())},queryState:function(e){return 1==e.getSelectedNodes().length?0:-1},queryValue:function(e){e=e.getSelectedNode();return e?e.getText():null}});r.extend(u,{_styleHooks:[],registerStyleHook:function(e){u._styleHooks.push(e)}}),p.extendClass(o,{getTextGroup:function(){return this.getRenderer("TextRenderer").getRenderShape()}}),a.register("text",{commands:{text:s},renderers:{center:u}}),n.exports=u}},m[62]={value:function(e,t,n){var s=m.r(17),r=(m.r(33),m.r(19),m.r(21),m.r(9)),o=m.r(20),i=(m.r(27),s.createClass("ViewDragger",{constructor:function(e){this._minder=e,this._enabled=!1,this._bind();var t=this;this._minder.getViewDragger=function(){return t},this.setEnabled(!1)},isEnabled:function(){return this._enabled},setEnabled:function(e){var t=this._minder.getPaper();t.setStyle("cursor",e?"pointer":"default"),t.setStyle("cursor",e?"-webkit-grab":"default"),this._enabled=e},timeline:function(){return this._moveTimeline},move:function(e,t){this._minder;e=this.getMovement().offset(e);this.moveTo(e,t)},moveTo:function(e,t){var n;if(t)return(n=this)._moveTimeline&&this._moveTimeline.stop(),this._moveTimeline=this._minder.getRenderContainer().animate(new s.Animator(this.getMovement(),e,function(e,t){n.moveTo(t)}),t,"easeOutCubic").timeline(),this._moveTimeline.on("finish",function(){n._moveTimeline=null}),this;this._minder.getRenderContainer().setTranslate(e.round()),this._minder.fire("viewchange")},getMovement:function(){var e=this._minder.getRenderContainer().transform.translate;return e?e[0]:new s.Point},getView:function(){var e=this._minder,t=e._lastClientSize||{width:e.getRenderTarget().clientWidth,height:e.getRenderTarget().clientHeight},n=this.getMovement(),t=new s.Box(0,0,t.width,t.height);return e.getPaper().getViewPortMatrix().inverse().translate(-n.x,-n.y).transformBox(t)},_bind:function(){var n,r=this,t=!1,o=null;function e(e){o&&(o=null,e.stopPropagation(),t&&(r.setEnabled(!1),t=!1,"hand"==r._minder.getStatus())&&r._minder.rollbackStatus(),r._minder.getPaper().setStyle("cursor","hand"==r._minder.getStatus()?"-webkit-grab":"default"),r._minder.fire("viewchanged"))}this._minder.on("normal.mousedown normal.touchstart inputready.mousedown inputready.touchstart readonly.mousedown readonly.touchstart",function(e){2==e.originEvent.button&&e.originEvent.preventDefault(),e.getTargetNode()!=this.getRoot()&&2!=e.originEvent.button&&!e.originEvent.altKey||(o=e.getPosition("view"),t=!0)}).on("normal.mousemove normal.touchmove readonly.mousemove readonly.touchmove inputready.mousemove inputready.touchmove",function(e){"touchmove"==e.type&&e.preventDefault(),t&&10<s.Vector.fromPoints(o,e.getPosition("view")).length()&&(this.setStatus("hand",!0),r._minder.getPaper().setStyle("cursor","-webkit-grabbing"))}).on("hand.beforemousedown hand.beforetouchstart",function(e){r.isEnabled()&&(o=e.getPosition("view"),e.stopPropagation(),r._minder.getPaper().setStyle("cursor","-webkit-grabbing"))}).on("hand.beforemousemove hand.beforetouchmove",function(e){var t;o&&(n=e.getPosition("view"),t=s.Vector.fromPoints(o,n),r.move(t),e.stopPropagation(),e.preventDefault(),e.originEvent.preventDefault(),o=n)}).on("mouseup touchend",e),window.addEventListener("mouseup",e),this._minder.on("contextmenu",function(e){e.preventDefault()})}}));o.register("View",function(){return{init:function(){this._viewDragger=new i(this)},commands:{hand:s.createClass("ToggleHandCommand",{base:r,execute:function(e){"hand"!=e.getStatus()?e.setStatus("hand",!0):e.rollbackStatus(),this.setContentChanged(!1)},queryState:function(e){return"hand"==e.getStatus()?1:0},enableReadOnly:!0}),camera:s.createClass("CameraCommand",{base:r,execute:function(e,t){t=t||e.getRoot();var n=e.getPaper().getViewPort(),t=t.getRenderContainer().getRenderBox("view"),r=n.center.x-t.x-t.width/2,n=n.center.y-t.y,t=e._viewDragger,e=e.getOption("viewAnimationDuration");t.move(new s.Point(r,n),e),this.setContentChanged(!1)},enableReadOnly:!0}),move:s.createClass("MoveCommand",{base:r,execute:function(e,t){var n=e._viewDragger,r=e._lastClientSize,o=e.getOption("viewAnimationDuration");switch(t){case"up":n.move(new s.Point(0,r.height/2),o);break;case"down":n.move(new s.Point(0,-r.height/2),o);break;case"left":n.move(new s.Point(r.width/2,0),o);break;case"right":n.move(new s.Point(-r.width/2,0),o)}},enableReadOnly:!0})},events:{statuschange:function(e){this._viewDragger.setEnabled("hand"==e.currentStatus)},mousewheel:function(e){var t,n,r;(e=e.originEvent).ctrlKey||e.shiftKey||(n="wheelDeltaX"in e?(t=e.wheelDeltaX||0,e.wheelDeltaY||0):(t=0,e.wheelDelta),this._viewDragger.move({x:t/2.5,y:n/2.5}),r=this,clearTimeout(this._mousewheeltimer),this._mousewheeltimer=setTimeout(function(){r.fire("viewchanged")},100),e.preventDefault())},"normal.dblclick readonly.dblclick":function(e){e.kityEvent.targetShape instanceof s.Paper&&this.execCommand("camera",this.getRoot(),800)},"paperrender finishInitHook":function(){this.getRenderTarget()&&(this.execCommand("camera",null,0),this._lastClientSize={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight})},resize:function(e){var t={width:this.getRenderTarget().clientWidth,height:this.getRenderTarget().clientHeight},n=this._lastClientSize;this._viewDragger.move(new s.Point((t.width-n.width)/2|0,(t.height-n.height)/2|0)),this._lastClientSize=t},"selectionchange layoutallfinish":function(e){var t,n,r,o,i=this.getSelectedNode(),a=this;s.Browser.edge&&this.fire("paperrender"),i&&((n=(t=this._viewDragger).timeline())?n.on("finish",function(){a.fire("selectionchange")}):(n=t.getView(),o=r=0,(i=i.getLayoutBox()).right>n.right?r+=n.right-i.right-50:i.left<n.left&&(r+=n.left-i.left+50),i.bottom>n.bottom&&(o+=n.bottom-i.bottom-50),i.top<n.top&&(o+=n.top-i.top+50),(r||o)&&t.move(new s.Point(r,o),100)))}}}})}},m[63]={value:function(e,t,n){var a=m.r(17),r=(m.r(33),m.r(19)),s=(m.r(21),m.r(9)),o=m.r(20);m.r(27);o.register("Zoom",function(){var o,t=this;function i(){var e=100<=t._zoomValue?"optimize-speed":"geometricPrecision";t.getRenderContainer().setAttr("text-rendering",e)}function n(e,t){var n,r;e.getPaper().getViewPort();t&&(i(),n=e.getOption("zoomAnimationDuration"),200<e.getRoot().getComplex()||!n?(e._zoomValue=t,e.zoom(t),e.fire("viewchange")):(r=new a.Animator({beginValue:e._zoomValue,finishValue:t,setter:function(e,t){e.zoom(t)}}),e._zoomValue=t,o&&o.pause(),(o=r.start(e,n,"easeInOutSine")).on("finish",function(){e.fire("viewchange")})),e.fire("zoom",{zoom:t}))}a.extendClass(r,{zoom:function(e){var t=this.getPaper(),n=t.getViewPort();n.zoom=e/100,n.center={x:n.center.x,y:n.center.y},t.setViewPort(n),100==e&&(e=(n=(n=t).shapeNode).getCTM(),e=new a.Matrix(e.a,e.b,e.c,e.d,.5+(0|e.e),.5+(0|e.f)),n.setAttribute("transform","matrix("+e.toString()+")"))},getZoomValue:function(){return this._zoomValue}});var e=a.createClass("Zoom",{base:s,execute:n,queryValue:function(e){return e._zoomValue}});return{init:function(){this._zoomValue=100,this.setDefaultOptions({zoom:[10,20,50,100,200]}),i()},commands:{zoomin:a.createClass("ZoomInCommand",{base:s,execute:function(e){n(e,this.nextValue(e))},queryState:function(e){return+!this.nextValue(e)},nextValue:function(e){for(var t=e.getOption("zoom"),n=0;n<t.length;n++)if(t[n]>e._zoomValue)return t[n];return 0},enableReadOnly:!0}),zoomout:a.createClass("ZoomOutCommand",{base:s,execute:function(e){n(e,this.nextValue(e))},queryState:function(e){return+!this.nextValue(e)},nextValue:function(e){for(var t=e.getOption("zoom"),n=t.length-1;0<=n;n--)if(t[n]<e._zoomValue)return t[n];return 0},enableReadOnly:!0}),zoom:e},events:{"normal.mousewheel readonly.mousewheel":function(e){var t,n;(e.originEvent.ctrlKey||e.originEvent.metaKey)&&(t=e.originEvent.wheelDelta,n=this,100<Math.abs(t))&&(clearTimeout(this._wheelZoomTimeout),this._wheelZoomTimeout=setTimeout(function(){n.getPaper()._zoom;0<t?n.execCommand("zoomin"):t<0&&n.execCommand("zoomout")},100),e.originEvent.preventDefault())}},commandShortcutKeys:{zoomin:"ctrl+=",zoomout:"ctrl+-"}}})}},m[64]={value:function(e,t,n){m.r(12).registerProtocol("json",n.exports={fileDescription:"KityMinder 格式",fileExtension:".km",dataType:"text",mineType:"application/json",encode:function(e){return JSON.stringify(e)},decode:function(e){return JSON.parse(e)}})}},m[65]={value:function(e,t,n){var r=m.r(12),l=/\r\n|\r|\n/,s="",d="\x3c!--Note--\x3e",g="\x3c!--/Note--\x3e";function o(e){return function t(e,n){var r=[];n=n||1;var o=u(n);r.push(o+" "+e.data.text);r.push(s);var i=e.data.note;{var a;i&&((a=/^#/.test(i))&&(r.push(d),i=i.replace(/^#+/gm,function(e){return o+e})),r.push(i),a&&r.push(g),r.push(s))}e.children&&e.children.forEach(function(e){r=r.concat(t(e,n+1))});return r}(e,1).join("\n")}function u(e){for(var t="";e--;)t+="#";return t}function i(e){for(var t,n,r,o,i,a,s,u={},c=(e=e.replace(/^(.+)\n={3,}/,function(e,t){return"# "+t})).split(l),h=0;h<c.length;h++)t=c[h],a=t,s=void 0,(s={level:(s=/^(#+)?\s*(.*)$/.exec(a))[1]&&s[1].length||null,content:s[2],noteStart:a==d,noteClose:a==g,codeBlock:/^\s*```/.test(a)}).noteClose?o=!1:s.noteStart?o=!0:(i=s.codeBlock?!i:i,o||i||!s.level||n+1<s.level?r&&(r.data.note+=t+"\n"):(r=function(e,t){e={data:{text:e,note:""}};t&&(t.children?t.children.push(e):t.children=[e]);return e}(s.content,u[(n=s.level)-1]),u[n]=r));return f(u[1]),u[1]}function f(e){if(/\S/.test(e.data.note)){for(var t=e.data.note.split("\n");t.length&&!/\S/.test(t[0]);)t.shift();for(;t.length&&!/\S/.test(t[t.length-1]);)t.pop();e.data.note=t.join("\n")}else e.data.note=null,delete e.data.note;e.children&&e.children.forEach(f)}r.registerProtocol("markdown",n.exports={fileDescription:"Markdown/GFM 格式",fileExtension:".md",mineType:"text/markdown",dataType:"text",encode:function(e){return o(e.root)},decode:i})}},m[66]={value:function(e,t,n){var b=m.r(17),r=m.r(12),w=m.r(25),x=window.URL||window.webkitURL||window;function S(r){return new w(function(e,t){var n=document.createElement("img");n.onload=function(){e({element:this,x:r.x,y:r.y,width:r.width,height:r.height})},n.onerror=function(e){t(e)},n.crossOrigin="anonymous",n.src=r.url})}function C(u){var e=u.getPaper(),c=(e.container,u.getRenderContainer()),t=c.getRenderBox(),n=t.width+1,r=t.height+1,o=e.shapeNode.getAttribute("transform"),i=(e.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),c.translate(-t.x,-t.y),i=e.container.innerHTML,c.translate(t.x,t.y),e.shapeNode.setAttribute("transform",o),(e=document.createElement("div")).innerHTML=i,(o=e.querySelector("svg")).setAttribute("width",t.width+1),o.setAttribute("height",t.height+1),o.setAttribute("style",'font-family: Arial, "Microsoft Yahei","Heiti SC";'),(e=document.createElement("div")).appendChild(o),(i=(i=(i=e.innerHTML).replace(' xmlns="http://www.w3.org/2000/svg" xmlns:NS1="" NS1:ns1:xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:NS2="" NS2:xmlns:ns1=""',"")).replace(/&nbsp;|[\x00-\x1F\x7F-\x9F]/g,"")).replace(/NS\d+:title/gi,"xlink:title")),t=new Blob([i],{type:"image/svg+xml"}),o=x.createObjectURL(t),h=[];return function e(t){var n=t.data;{var r,o,i;n.image&&(u.renderNode(t),i=(n=t.data).image,r=n.imageSize,o=t.getRenderBox("ImageRenderer",u.getRenderContainer()),i={url:i,width:r.width,height:r.height,x:-c.getBoundaryBox().x+o.x,y:-c.getBoundaryBox().y+o.y},h.push(i))}if("collapse"===n.expandState)return;var a=t.getChildren();for(var s=0;s<a.length;s++)e(a[s])}(u.getRoot()),{width:n,height:r,dataUrl:o,xml:i,imagesInfo:h}}r.registerProtocol("png",n.exports={fileDescription:"PNG 图片",fileExtension:".png",mineType:"image/png",dataType:"base64",encode:function(e,t,n){var r=document.createElement("canvas"),o=r.getContext("2d"),i=t.getStyle("background").toString(),a=/url\(\"(.+)\"\)/.exec(i),i=b.Color.parse(i),t=C(t),s=(n&&n.width&&n.width>t.width?n:t).width,u=(n&&n.height&&n.height>t.height?n:t).height,c=n&&n.width&&n.width>t.width?(n.width-t.width)/2:0,h=n&&n.height&&n.height>t.height?(n.height-t.height)/2:0,l=t.dataUrl,d=t.imagesInfo,g=20;function f(e,t){e.save(),e.fillStyle=t,e.fillRect(0,0,r.width,r.height),e.restore()}function m(e,t,n,r,o,i){o&&i?e.drawImage(t,n+g,r+g,o,i):e.drawImage(t,n+g,r+g)}function p(e){return e.toDataURL("image/png")}function y(e){e=e.map(function(e){return o=e,w(function(n,e){var r=new XMLHttpRequest;r.open("GET",o.url+"?_="+Date.now(),!0),r.responseType="blob",r.onreadystatechange=function(){var e,t;4===r.readyState&&200===r.status&&(e=r.response,(t=document.createElement("img")).src=x.createObjectURL(e),t.onload=function(){x.revokeObjectURL(t.src),n({element:t,x:o.x,y:o.y,width:o.width,height:o.height})})},r.send()});var o});return w.all(e)}function v(){return S({url:l}).then(function(e){return m(o,e.element,c,h,e.width,e.height),y(d)}).then(function(e){for(var t=0;t<e.length;t++)m(o,e[t].element,e[t].x+c,e[t].y+h,e[t].width,e[t].height);x.revokeObjectURL(l),document.body.appendChild(r);var n=p(r);return document.body.removeChild(r),n},function(e){alert("脑图的节点中包含跨域图片，导出的 png 中节点图片不显示，你可以替换掉这些跨域的图片并重试。"),x.revokeObjectURL(l),document.body.appendChild(r);var t=p(r);return document.body.removeChild(r),t})}return r.width=s+2*g,r.height=u+2*g,a?S({url:a[1]}).then(function(e){return f(o,o.createPattern(e.element,"repeat")),v()}):(f(o,i.toString()),v())}})}},m[67]={value:function(e,t,n){function u(e,t,n){e.style.visibility="hidden",function e(t,n,r){if(t&&"defs"!==t.tagName){var o,i;switch("transparent"===t.getAttribute("fill")&&t.setAttribute("fill","none"),t.getAttribute("marker-end")&&t.removeAttribute("marker-end"),n=n||0,r=r||0,t.getAttribute("transform")&&(o=function(e,t){var n;try{n=t.getScreenCTM().inverse()}catch(e){throw new Error("Can not inverse source element' ctm.")}return n.multiply(e.getScreenCTM())}(t,t.parentElement),n-=o.e,r-=o.f,t.removeAttribute("transform")),t.tagName.toLowerCase()){case"g":break;case"path":var a=t.getAttribute("d");return void(a&&(a=function(e,t){t instanceof Function||(t=function(){});for(var n=[],r=[],o=[],i=0,a=e.length;i<a;i++)switch(e[i]){case"M":case"L":case"T":case"S":case"A":case"C":case"H":case"V":case"Q":o.length&&(r.push(o.join("")),o=[]),","===r[r.length-1]&&r.pop(),r.length&&(t(r),n.push(r.join("")),r=[]),r.push(e[i]);break;case"Z":case"z":r.push(o.join(""),e[i]),t(r),n.push(r.join("")),o=[],r=[];break;case".":case"e":o.push(e[i]);break;case"-":"e"!==e[i-1]&&(o.length&&r.push(o.join(""),","),o=[]),o.push("-");break;case" ":case",":o.length&&(r.push(o.join(""),","),o=[]);break;default:/\d/.test(e[i])?o.push(e[i]):o.length?(r.push(o.join(""),e[i]),o=[]):(","===r[r.length-1]&&r.pop(),r.push(e[i])),i+1===a&&(o.length&&r.push(o.join("")),t(r),n.push(r.join("")),r=o=null)}return n.join("")}(a,function(e){switch(e[0]){case"V":e[1]=+e[1]-r;break;case"H":e[1]=+e[1]-n;break;case"M":case"L":case"T":e[1]=+e[1]-n,e[3]=+e[3]-r;break;case"Q":case"S":e[1]=+e[1]-n,e[3]=+e[3]-r,e[5]=+e[5]-n,e[7]=+e[7]-r;break;case"A":e[11]=+e[11]-n,e[13]=+e[13]-r;break;case"C":e[1]=+e[1]-n,e[3]=+e[3]-r,e[5]=+e[5]-n,e[7]=+e[7]-r,e[9]=+e[9]-n,e[11]=+e[11]-r}}),t.setAttribute("d",a),t.removeAttribute("transform")));case"image":case"text":return n&&r&&(a=+t.getAttribute("x")||0,i=+t.getAttribute("y")||0,t.setAttribute("x",a-n),t.setAttribute("y",i-r)),t.getAttribute("dominant-baseline")&&(t.removeAttribute("dominant-baseline"),t.setAttribute("dy",".8em")),void t.removeAttribute("transform")}if(t.children)for(var s=0,u=t.children.length;s<u;s++)e(t.children[s],n,r)}}(e,t||0,n||0),e.style.visibility="visible"}m.r(12).registerProtocol("svg",n.exports={fileDescription:"SVG 矢量图",fileExtension:".svg",mineType:"image/svg+xml",dataType:"text",encode:function(e,t){var n,r=t.getPaper(),o=r.shapeNode.getAttribute("transform"),i=t.getRenderContainer(),a=i.getRenderBox(),i=(i.getTransform(),a.width),s=a.height;return r.shapeNode.setAttribute("transform","translate(0.5, 0.5)"),n=r.container.innerHTML,r.shapeNode.setAttribute("transform",o),r=document.createElement("div"),document.body.appendChild(r),r.innerHTML=n,(o=r.querySelector("svg")).setAttribute("width",i+40|0),o.setAttribute("height",s+40|0),o.setAttribute("style","background: "+t.getStyle("background")),o.setAttribute("viewBox",[0,0,i+40|0,s+40|0].join(" ")),tempSvgContainer=document.createElement("div"),u(o,a.x-20|0,a.y-20|0),document.body.removeChild(r),tempSvgContainer.appendChild(o),n=(n=tempSvgContainer.innerHTML).replace(/&nbsp;/g,"&#xa0;")}})}},m[68]={value:function(e,t,n){var r=m.r(12),o=m.r(17).Browser,c=/\r\n|\r|\n/,h=(o=o).gecko?{REGEXP:new RegExp("^(\t|"+String.fromCharCode(160,160,32,160)+")"),DELETE:new RegExp("^(\t|"+String.fromCharCode(160,160,32,160)+")+")}:o.ie||o.edge?{REGEXP:new RegExp("^("+String.fromCharCode(32)+"|"+String.fromCharCode(160)+")"),DELETE:new RegExp("^("+String.fromCharCode(32)+"|"+String.fromCharCode(160)+")+")}:{REGEXP:/^(\t|\x20{4})/,DELETE:/^(\t|\x20{4})+/};function i(e,t){var n="",n=(n+=function(e,t){for(var n="";t--;)n+=e;return n}("\t",t=t||0))+(function(e){if(!e)return"";for(var t=[],n=["\\","n"],r=0,o=0,i=e.length;r<i;r++)if("\n"===e[r]||"\r"===e[r])t.push("\\n"),o=0;else if(e[r]===n[o])2===++o&&(o=0,t.push("\\\\n"));else{switch(o){case 0:t.push(e[r]);break;case 1:t.push(e[r-1],e[r])}o=0}return t.join("")}(e.data.text)+"\r");return e.children&&e.children.forEach(function(e){n+=i(e,t+1)}),n}function l(e){return{data:{text:function(e){if(!e)return"";for(var t=[],n=["\\","\\","n"],r=0,o=0,i=e.length;r<i;r++)if(e[r]===n[o])3===++o&&(o=0,t.push("\\n"));else switch(o){case 0:t.push(e[r]),o=0;break;case 1:"n"===e[r]?t.push("\n"):t.push(e[r-1],e[r]),o=0;break;case 2:t.push(e[r-2]),"\\"!==e[r]&&(o=0,t.push(e[r-1],e[r]))}return t.join("")}(e.replace(h.DELETE,""))}}}function a(e){var t,n,r,o={},i=e.split(c);for(var a,s,u=0;u<i.length;u++)if(r=i[u],/\S/.test(r)){if(n=function(e){for(var t=0;h.REGEXP.test(e);)e=e.replace(h.REGEXP,""),t++;return t}(r),r=l(r),0===n){if(t)throw new Error("Invalid local format");t=r}else{if(!o[n-1])throw new Error("Invalid local format");a=o[n-1],s=r,(a.children||(a.children=[])).push(s)}o[n]=r}return t}function s(e){if(e)return/^\s*$/.test(e.data.text)&&(e.data.text="分支主题"),i(function e(t){var n={},r=(n.data=t.getData(),t.getChildren());n.children=[];for(var o=0;o<r.length;o++)n.children.push(e(r[o]));return n}(e))}r.registerProtocol("text",n.exports={fileDescription:"大纲文本",fileExtension:".txt",dataType:"text",mineType:"text/plain",encode:function(e){return i(e.root,0)},decode:a,Node2Text:s})}},m[69]={value:function(e,t,n){m.r(31).register("default",{getLayout:function(e){var t;return e.getData("layout")?e.getData("layout"):0===(t=e.getLevel())?"mind":1===t?0<e.getLayoutPointPreview().x?"right":"left":e.parent.getLayout()},getConnect:function(e){return 1==e.getLevel()?"arc":"under"}})}},m[70]={value:function(e,t,n){m.r(31).register("filetree",{getLayout:function(e){return e.getData("layout")?e.getData("layout"):e.isRoot()?"bottom":"filetree-down"},getConnect:function(e){return 1==e.getLevel()?"poly":"l"}})}},m[71]={value:function(e,t,n){m.r(31).register("fish-bone",{getLayout:function(e){var t;return e.getData("layout")?e.getData("layout"):0===(t=e.getLevel())?"fish-bone-master":1===t?"fish-bone-slave":0<e.getLayoutPointPreview().y?"filetree-up":"filetree-down"},getConnect:function(e){switch(e.getLevel()){case 1:return"fish-bone-master";case 2:return"line";default:return"l"}}})}},m[72]={value:function(e,t,n){m.r(31).register("right",{getLayout:function(e){return e.getData("layout")||"right"},getConnect:function(e){return 1==e.getLevel()?"arc":"bezier"}})}},m[73]={value:function(e,t,n){m.r(31).register("structure",{getLayout:function(e){return e.getData("layout")||"bottom"},getConnect:function(e){return"poly"}})}},m[74]={value:function(e,t,n){m.r(31).register("tianpan",{getLayout:function(e){return e.getData("layout")?e.getData("layout"):0===e.getLevel()?"tianpan":e.parent.getLayout()},getConnect:function(e){return"arc_tp"}})}},m[75]={value:function(e,t,n){var r=m.r(32);["classic","classic-compact"].forEach(function(e){var t="classic-compact"==e;r.register(e,{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":t?[10,25]:[15,25],"root-margin":t?[15,25]:[30,100],"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":t?[5,15]:[6,20],"main-margin":t?[5,10]:20,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"white","sub-background":"transparent","sub-stroke":"none","sub-font-size":12,"sub-padding":[5,10],"sub-margin":t?[5,10]:[15,20],"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})})}},m[76]={value:function(e,t,n){m.r(32).register("fish",{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":[35,35],"root-margin":30,"root-radius":100,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":[6,20],"main-margin":[20,20],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":[10],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":3,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})}},m[77]={value:function(e,t,n){var r=m.r(17),o=m.r(32);function i(e,t,n){return r.Color.createHSL(e,t,n)}function a(e,t){return{background:"#fbfbfb","root-color":"white","root-background":i(e,37,60),"root-stroke":i(e,37,60),"root-font-size":16,"root-padding":t?[6,12]:[12,24],"root-margin":t?10:[30,100],"root-radius":5,"root-space":10,"main-color":"black","main-background":i(e,33,95),"main-stroke":i(e,37,60),"main-stroke-width":1,"main-font-size":14,"main-padding":[6,20],"main-margin":t?8:20,"main-radius":3,"main-space":5,"sub-color":"black","sub-background":"transparent","sub-stroke":"none","sub-font-size":12,"sub-padding":t?[3,5]:[5,10],"sub-margin":t?[4,8]:[15,20],"sub-radius":5,"sub-space":5,"connect-color":i(e,37,60),"connect-width":1,"connect-radius":5,"selected-stroke":i(e,26,30),"selected-stroke-width":"3","blur-selected-stroke":i(e,10,60),"marquee-background":i(e,100,80).set("a",.1),"marquee-stroke":i(e,37,60),"drop-hint-color":i(e,26,35),"drop-hint-width":5,"order-hint-area-color":i(e,100,30).set("a",.5),"order-hint-path-color":i(e,100,25),"order-hint-path-width":1,"text-selection-color":i(e,100,20),"line-height":1.5}}var s,u={red:0,soil:25,green:122,blue:204,purple:246,pink:334};for(s in u)o.register("fresh-"+s,a(u[s])),o.register("fresh-"+s+"-compat",a(u[s],!0))}},m[78]={value:function(e,t,n){var r=m.r(32);["snow","snow-compact"].forEach(function(e){var t="snow-compact"==e;r.register(e,{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":24,"root-padding":t?[5,10]:[15,25],"root-margin":t?15:30,"root-radius":5,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":16,"main-padding":t?[4,10]:[6,20],"main-margin":t?[5,10]:[20,40],"main-radius":5,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","sub-color":"black","sub-background":"white","sub-stroke":"white","sub-font-size":12,"sub-padding":[5,10],"sub-margin":t?[5,10]:[10,20],"sub-radius":5,"sub-space":5,"connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})})}},m[79]={value:function(e,t,n){var r=m.r(32);["tianpan","tianpan-compact"].forEach(function(e){var t="tianpan-compact"==e;r.register(e,{background:'#3A4144 url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowQzg5QTQ0NDhENzgxMUUzOENGREE4QTg0RDgzRTZDNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDowQzg5QTQ0NThENzgxMUUzOENGREE4QTg0RDgzRTZDNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwOEQ1NDRGOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwOEQ1NDUwOEQ3NzExRTM4Q0ZEQThBODREODNFNkM3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+e9P33AAAACVJREFUeNpisXJ0YUACTAyoAMr/+eM7EGGRZ4FQ7BycEAZAgAEAHbEGtkoQm/wAAAAASUVORK5CYII=") repeat',"root-color":"#430","root-background":"#e9df98","root-stroke":"#e9df98","root-font-size":25,"root-padding":t?15:20,"root-margin":t?[15,25]:100,"root-radius":30,"root-space":10,"root-shadow":"rgba(0, 0, 0, .25)","root-shape":"circle","main-color":"#333","main-background":"#a4c5c0","main-stroke":"#a4c5c0","main-font-size":15,"main-padding":t?10:12,"main-margin":t?10:12,"main-radius":10,"main-space":5,"main-shadow":"rgba(0, 0, 0, .25)","main-shape":"circle","sub-color":"#333","sub-background":"#99ca6a","sub-stroke":"#a4c5c0","sub-font-size":13,"sub-padding":5,"sub-margin":t?6:10,"sub-tree-margin":30,"sub-radius":5,"sub-space":5,"sub-shadow":"rgba(0, 0, 0, .25)","sub-shape":"circle","connect-color":"white","connect-width":2,"main-connect-width":3,"connect-radius":5,"selected-background":"rgb(254, 219, 0)","selected-stroke":"rgb(254, 219, 0)","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.4})})}},m[80]={value:function(e,t,n){m.r(32).register("wire",{background:"black",color:"#999",stroke:"none",padding:10,margin:20,"font-size":14,"connect-color":"#999","connect-width":1,"selected-background":"#999","selected-color":"black","marquee-background":"rgba(255,255,255,.3)","marquee-stroke":"white","drop-hint-color":"yellow","sub-drop-hint-width":2,"main-drop-hint-width":4,"root-drop-hint-width":4,"order-hint-area-color":"rgba(0, 255, 0, .5)","order-hint-path-color":"#0f0","order-hint-path-width":1,"text-selection-color":"rgb(27,171,255)","line-height":1.5})}},m.r([{"expose-kityminder":34}["expose-kityminder"]])}();